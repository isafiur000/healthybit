' Gambas class file

Private $dict As String[]
Private $sValue As String

Public Sub Run(sList As String[]) As String

  $dict = sList

  If Me.ShowModal() Then Return $sValue

End

Public Sub Form_Open()

  GridView1.Clear
  GridView1.Columns.Count = 1
  GridView1.Rows.Count = $dict.Count
  GridView1.Row = 0

End

Public Sub GridView1_Data(Row As Integer, Column As Integer)

  modGeneralMain.GridViewDecoration(GridView1, Row)
  GridView1.Data.Text = $dict[Row]

End

Public Sub GridView1_KeyPress()

  If Key.Code = Key.Return Or If Key.Code = Key.Enter Or If Key.Code = Key.AltKey Then
    If GridView1.Rows.Selection.Count Then
      $sValue = GridView1[GridView1.Row, 0].Text
      Me.Close(True)
    Else
      Me.Close
    Endif
  Else If Key.Code = Key.Escape Then
    Me.Close
  Endif

End

Public Sub Form_Resize()

  Me.Center

End

Public Sub GridView1_Click()

  If GridView1.Rows.Selection.Count Then
    $sValue = GridView1[GridView1.Row, 0].Text
    Me.Close(True)
  Else
    Me.Close
  Endif

End
