' Gambas class file

Private $sList As String[]
Private $sValue As String

Public Sub Run(sPrompt As String, sTitle As String, sList As String[]) As String

  Label1.Text = sPrompt
  Me.Title = sTitle
  $sList = sList
  If Me.ShowModal() Then Return $sValue

End

Public Sub Form_Open()

  txtselect.SetFocus
  lstletter.List = modString.GetFirstLetterArray($sList)
  DisplayDictgrid()

End

Private Sub DisplayDictgrid()

  ListBox1.List = modString.SelectStringArrayToText(txtselect.Text, $sList)
  ListBox1.Index = 0

End

Public Sub lstletter_Click()

  txtselect.Text = lstletter.Text
  DisplayDictgrid()

End

Public Sub txtselect_Change()

  DisplayDictgrid()

End

Public Sub txtselect_KeyRelease()

  If Key.Code = Key.Down Then
    ListBox1.SetFocus
  Else If Key.Code = Key.Return Or If Key.Code = Key.Enter Or If Key.Code = Key.AltKey Then
    $sValue = ListBox1.Text
    Me.Close(True)
  Endif

End

Public Sub Form_KeyRelease()

  If Key.Code = Key.Return Or If Key.Code = Key.Enter Or If Key.Code = Key.AltKey Then
    $sValue = ListBox1.Text
    Me.Close(True)
  Else If Key.Code = Key.Esc Then
    Me.Close
  Endif

End

Public Sub btnok_Click()

  $sValue = ListBox1.Text
  Me.Close(True)

End

Public Sub txtselect_Click()

  txtselect.Text = ""

End
