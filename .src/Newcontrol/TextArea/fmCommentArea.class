' Gambas class file

Private $sTitle As String
Private $sValue As String

Public Sub Run(Optional sTitle As String, Optional sDefault As String) As String

  If sTitle Then
    $sTitle = sTitle
  Else
    $sTitle = Application.Title
  Endif
  If sDefault Then
    $sValue = sDefault
  Endif

  If Me.ShowModal() Then Return $sValue

End

Public Sub Form_Open()

  Me.Title = $sTitle
  TextArea1.Text = $sValue
  TextArea1.SetFocus

End

Public Sub btnok_Click()

  If chkreport.Value = True Then
    $sValue = TextArea1.Text & gb.NewLine & "[Report Required]"
  Else
    $sValue = TextArea1.Text
  Endif
  Me.Close(True)

End

Public Sub Form_KeyRelease()

  If Key.Code = Key.Esc Then
    Me.Close
  Endif

End

Public Sub TextArea1_KeyPress()

  modGeneralMain.InputTextKeyOnly()

End
