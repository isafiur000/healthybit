' Gambas class file

Public Sub Form_Open()

  modGeneralMain.ArrangeFormCentre(Me, "False")
  cmbcomp.List = modGeneral.GetCurrentCompOnSys()

End

Public Sub cmbcomp_Click()

  lbldept.Text = modGeneral.GetCompNameFromCompID(cmbcomp.Text)

End

Public Sub btnsend_Click()

  Dim xx As String

  If txtnotice.Text Then
    If cmbcomp.Text Then

      If chkall.Value = True Then
        For Each xx In cmbcomp.List
          modControl.SendCompIDNotofication(xx, txttitle.Text, txtnotice.Text)
        Next
      Else
        modControl.SendCompIDNotofication(cmbcomp.Text, txttitle.Text, txtnotice.Text)
      Endif

      txtnotice.Text = ""
      Balloon.Info(("Message sent"), btnsend)
      Balloon.Delay = modBasic.$BalloonDelay
    Endif
  Endif

End
