' Gambas class file

Private $encid As String
Private $sValue As Collection

Public Sub Run(encid As String) As Collection

  $encid = encid

  $sValue = New Collection
  If Me.ShowModal() Then Return $sValue

End

Public Sub Form_Open()

  modGeneralMain.ArrangeFormCentre(Me)
  txtpatnme.Text = modPatient.GetPatientNameByEnc($encid)

End

Public Sub Form_KeyRelease()

  If Key.Code = Key.Esc Then
    Me.Close
  Else
    modGeneralmain.GoToNextControlTab()
  Endif

End

Public Sub btneditall_Click()

  Dim sColl As Collection

  sColl = New Collection
  sColl.Add(txtlabper.Value, "Diagnostic Tests")
  sColl.Add(txtradioper.Value, "Radio Diagnostics")
  sColl.Add(txtserviceper.Value, "General Services")
  sColl.Add(txtprocper.Value, "Procedures")
  sColl.Add(txtequipper.Value, "Equipment")
  sColl.Add(txtotherper.Value, "Other Items")
  sColl.Add(txtmedper.Value, "Medicines")
  sColl.Add(txtsurgper.Value, "Surgicals")
  sColl.Add(txtextraper.Value, "Extra Items")

  $sValue = sColl
  Me.Close(True)

End
