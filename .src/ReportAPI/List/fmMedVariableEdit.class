' Gambas class file

Private $txt As TextArea
Private $iPos As Integer
Private $sLevel As Integer

Public Sub _new(iPos As Integer, txt As TextArea, sLevel As Integer)

  $iPos = iPos
  $txt = txt
  $sLevel = sLevel

End

Public Sub Form_Resize()

  Me.Center

End

Public Sub Form_Open()

  If $sLevel > 0 Then
    ListView1.Add("{ColumnData}", "Column Data")
    ListView1.Add("{HospitalName}", "Hospital Name")
    ListView1.Add("{HospitalAddress}", "Hospital Address")
    ListView1.Add("{Department}", "Print Department")
    ListView1.Add("{CurrentDate}", "Current Date")
    ListView1.Add("{CurrentTime}", "Current Time")
    ListView1.Add("{CurrentUser}", "Current User")
  Endif

  If $sLevel > 1 Then
    ListView1.Add("{BookingNo}", "Booking No")
    ListView1.Add("{Encounter}", "Encounter ID")
    ListView1.Add("{PatientNo}", "Patient No")
    ListView1.Add("{PatientCode}", "Patient Code")
    ListView1.Add("{PatientName}", "Patient Name")
    ListView1.Add("{PatientEthnicity}", "Ethnic Group")

    ListView1.Add("{PatientMunicipality}", "Patient Municipality")
    ListView1.Add("{PatientWardAddress}", "Patient Ward Address")
    ListView1.Add("{PatientAddress}", "Patient Address")
    ListView1.Add("{PatientDistrict}", "Patient District")
    ListView1.Add("{PatientProvince}", "Patient Province")
    ListView1.Add("{PatientGender}", "Patient Gender")
    ListView1.Add("{PatientGuardian}", "Guardian")
    ListView1.Add("{PatientDOB}", "Date of Birth")
    ListView1.Add("{PatientAge}", "Current Age")
    ListView1.Add("{AgeGroup}", "Age Group")
    ListView1.Add("AgeGroupCustom", "Custom Age Group")
    ListView1.Add("{Age/Sex}", "Age/Sex")
    ListView1.Add("{E-Mail}", "E-Mail Address")
    ListView1.Add("{ContactNo}", "Contact No")
    ListView1.Add("{PatientFileNo}", "Patient FileNo")
    ListView1.Add("{PatientRelation}", "Patient Relation")
    ListView1.Add("{MotherEncounter}", "Mother Encounter ID")
    ListView1.Add("{MotherPatientNo}", "Mother Patient No")
    ListView1.Add("{MotherName}", "Mother Name")
    ListView1.Add("{DiscountPackae}", "Discount Package")

    ListView1.Add("{ServiceType}", "Service Type")
    ListView1.Add("{ServiceRank}", "Service Rank")
    ListView1.Add("{ServiceUnit}", "Service Unit")

    ListView1.Add("{RegdDepartment}", "Regd Department")
    ListView1.Add("{RegdDeptRoom}", "Regd Department Room")
    ListView1.Add("{BedNo}", "Current Location")
    ListView1.Add("{WardName}", "Ward Name")
    ListView1.Add("{FirstWardName}", "First Ward Name")
    ListView1.Add("{CurrDepartment}", "Current Department")
    ListView1.Add("{RegdBillMode}", "Regd RatePlan")
    ListView1.Add("{RegistrationDate}", "Registration Date")
    ListView1.Add("{RegistrationTime}", "Registration Time")
    ListView1.Add("{VisitMode}", "Visit Mode")
    ListView1.Add("{AdmissionDate}", "Admission Date")
    ListView1.Add("{AdmissionTime}", "Admission Time")
    ListView1.Add("{DischargeDate}", "Discharge Date")
    ListView1.Add("{DischargeTime}", "Discharge Time")
    ListView1.Add("{ClearanceDateTime}", "Clearance Date")
    ListView1.Add("{AdmitDurationHour}", "Inpatient Duration")
    ListView1.Add("{FollowUpDate}", "Follow Up Date")
    ListView1.Add("{FollowUpTime}", "Follow Up Time")
    ListView1.Add("{ReferLocation}", "Refer Location")
    ListView1.Add("{CurrentStatus}", "Admission Status")
    ListView1.Add("{CurrentStatusComment}", "Status with Comment")
    ListView1.Add("{Consultant}", "Consultant")
    ListView1.Add("{ConsultantID}", "Consultant ID")
    ListView1.Add("{RegdConsultationFree}", "RegdConsultation Free")

    ListView1.Add("{RegistrationUser}", "Registration User")
    ListView1.Add("{AdmissionUser}", "Admission User")
    ListView1.Add("{DischargeUser}", "Discharge User")
    ListView1.Add("{ClearanceUser}", "Discharge Clearance")

    ListView1.Add("{TotalExpense}", "Total Expense")
    ListView1.Add("{TotalPayment}", "Total Payment")
    ListView1.Add("{CurrentDeposit}", "Current Deposit")
    ListView1.Add("{NonInvoicedExpenses}", "Non-Invoiced Expenses")
    ListView1.Add("{BalanceDeposit}", "Balance Deposit")

    ListView1.Add("{FirstInvoiceNumber}", "First InvoiceNumber")
    ListView1.Add("{LastInvoiceNumber}", "Last InvoiceNumber")
    ListView1.Add("{FirstInvoiceAmount}", "First InvoiceAmount")
    ListView1.Add("{LastInvoiceAmount}", "Last InvoiceAmount")
    ListView1.Add("{FirstReceiptNumber}", "First ReceiptNumber")
    ListView1.Add("{LastReceiptNumber}", "Last ReceiptNumber")
    ListView1.Add("{LastInvReference}", "Last InvoiceReference")
    ListView1.Add("{FirstClaimCode}", "First Claim Code")
    ListView1.Add("{LastClaimCode}", "Last Claim Code")
    ListView1.Add("{PatientTriageColor}", "Triage Color")
    ListView1.Add("{PatientTriageSymbol}", "Triage Symbol")

    ListView1.Add("{LastConsultDept}", "LastConsultDept")
    ListView1.Add("{LastConsultRoom}", "LastConsultRoom")
    ListView1.Add("{LastConsultant}", "LastConsultant")
    ListView1.Add("{LastConsultBillMode}", "LastConsultBillMode")
    ListView1.Add("{LastConsultDate}", "LastConsultDate")
    ListView1.Add("{LastConsultTime}", "LastConsultTime")
    ListView1.Add("{LastConsultStatus}", "LastConsultStatus")
    ListView1.Add("{LastConsultComment}", "LastConsultComment")
    ListView1.Add("{LastConsultOutcome}", "LastConsultOutcome")
    ListView1.Add("{LastConsultQue}", "LastConsultQue")
    ListView1.Add("{LastOPVisitDept}", "LastOPVisitDept")
    ListView1.Add("{LastOPVisitRoom}", "LastOPVisitRoom")
    ListView1.Add("{LastOPVisitBillMode}", "LastOPVisitBillMode")
    ListView1.Add("{LastOPVisitDate}", "LastOPVisitDate")
    ListView1.Add("{LastOPVisitTime}", "LastOPVisitTime")
    ListView1.Add("{LastOPVisitStatus}", "LastOPVisitStatus")
    ListView1.Add("{LastOPVisitComment}", "LastOPVisitComment")
    ListView1.Add("{LastOPVisitOutcome}", "LastOPVisitOutcome")
    ListView1.Add("{LastVisitDate}", "LastVisitDate")
    ListView1.Add("{LastVisitTime}", "LastVisitTime")
    ListView1.Add("{LastVisitLocation}", "LastVisitLocation")
  Endif

  If $sLevel > 2 Then
    ListView1.Add("{Weight}", "Weight(Kg)")
    ListView1.Add("{Height}", "Height(cm)")
    ListView1.Add("{HepaticStatus}", "Hepatic Status")
    ListView1.Add("{PregnancyStatus}", "Pregnancy Status")
    ListView1.Add("{BloodPressure_Systolic}", "Systolic BP")
    ListView1.Add("{BloodPressure_Diastolic}", "Diastolic BP")
    ListView1.Add("{BloodPressure_Systolic/Diastolic}", "Systolic/Diastolic BP")
    ListView1.Add("{Pulse_Rate}", "Pulse Rate")
    ListView1.Add("{Respiration_Rate}", "Respiration Rate")
    ListView1.Add("{Temperature_System}", "Temperature")

    ListView1.Add("{PresentingSymptoms}", "Presenting Complaints")
    ListView1.Add("{GeneralComplaints}", "General Complaints")

    ListView1.Add("{ClinicalFindings}", "Clinical Findings")
    ListView1.Add("{TriageExaminations}", "Triage Examinations")
    ListView1.Add("{EssentialExaminations}", "Essential Examinations")
    ListView1.Add("{PhysicianExaminations}", "Physician Examinations")
    ListView1.Add("{NursingExaminations}", "Nursing Examinations")
    ListView1.Add("{PhysicianStructured}", "Physician Structured")
    ListView1.Add("{DepartmentStructured}", "Department Structured")
    ListView1.Add("{DischargeExaminations}", "Discharge Examinations")

    ListView1.Add("{AdmissionCause}", "Cause of Admission")
    ListView1.Add("{HistoryofIllness}", "History of Illness")
    ListView1.Add("{PastHistory}", "Past History")
    ListView1.Add("{FamilyHistory}", "Family History")
    ListView1.Add("{TreatmentHistory}", "Treatment History")
    ListView1.Add("{MedicationHistory}", "Medication History")
    ListView1.Add("{PersonalHistory}", "Personal History")
    ListView1.Add("{SurgicalHistory}", "Surgical History")
    ListView1.Add("{OccupationalHistory}", "Occupational History")
    ListView1.Add("{SocialHistory}", "Social History")

    ListView1.Add("{InvestigationAdvised}", "Investigation Advised")
    ListView1.Add("{TreatmentAdvised}", "Treatment Advised")
    ListView1.Add("{SurgicalRequests}", "Surgical Request")
    ListView1.Add("{ExtraRequests}", "Extra Request")

    ListView1.Add("{FinalDiagnosis}", "Final Diagnosis")
    ListView1.Add("{ProvisionalDiagnosis}", "Provisional Diagnosis")
    ListView1.Add("{FinalDiagnosisClass}", "Final Diagnosis Class")
    ListView1.Add("{ProvisionalDiagnosisClass}", "Provisional Diagnosis Class")
    ListView1.Add("{PatientDiagnosis}", "Patient Diagnosis")
    ListView1.Add("{PatientDiagnosisClass}", "Patient Diagnosis Class")

    ListView1.Add("{OPDRecommendation}", "Initial Planning")
    ListView1.Add("{ExpertRecommendation}", "Final Planning")
    ListView1.Add("{IndoorMedicines}", "Indoor Medications")
    ListView1.Add("{DischargeMedicines}", "Discharge Medications")
    ListView1.Add("{DischargeCondition}", "Discharge Condition")
    ListView1.Add("{DischargeNote}", "Discharge Note")
    ListView1.Add("{DischargeOutcome}", "Outcome of Discharge")
    ListView1.Add("{CauseOfDeath}", "Cause of Death")
    ListView1.Add("{BSISummary}", "BSI Summary")
    ListView1.Add("{UTISummary}", "UTI Summary")
  Endif

End

Public Sub Form_KeyRelease()

  If Key.Code = Key.Return Or If Key.Code = Key.Enter Or If Key.Code = Key.AltKey Then
    $txt.Text = Left($txt.Text, $iPos - 1) & ListView1.Key
    Me.Close
  Else If Key.Code = Key.Escape Then
    Me.Close
  Endif

End

Public Sub ListView1_Click()

  $txt.Text = Left($txt.Text, $iPos - 1) & ListView1.Key
  Me.Close

End
