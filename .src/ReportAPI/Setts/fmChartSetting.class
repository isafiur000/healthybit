' Gambas class file

Private $ageFile As File

Public Sub Form_Open()

  Dim hForm As FmUnivariate
  Dim hForm1 As FmBivariate
  Dim hForm2 As FmGridSummary
  Dim hForm3 As FmCrossTabChart
  Dim hForm4 As FmTimeSeries
  Dim hForm5 As FmRegression

  modGeneralMain.ArrangeFormCentre(Me)
  hForm = New FmUnivariate(Panel2)
  hForm1 = New FmBivariate(Panel3)
  hForm2 = New FmGridSummary(Panel4)
  hForm3 = New FmCrossTabChart(Panel1)
  hForm4 = New FmTimeSeries(Panel6)
  hForm5 = New FmRegression(Panel5)

  cmbcurve.List = ["Yes", "No"]
  cmbclinpoint.List = ["Yes", "No"]
  cmbclinlabel.List = ["Yes", "No"]
  cmbclinup.List = ["Yes", "No"]
  cmbclinlow.List = ["Yes", "No"]
  cmbclinormal.List = ["Yes", "No"]
  cmbclinhour.List = ["Yes", "No"]
  cmbclindaylabel.List = ["Yes", "No"]

  cmbfintitle.List = ["Yes", "No"]
  cmbfinxlabel.List = ["Yes", "No"]
  cmbfinylabel.List = ["Yes", "No"]
  cmbfinstat.List = ["GNUChart", "PSPP"]

  cmbchartday.List = ["Day", "Week", "Month", "Year"]
  cmbfinamtgrp.List = ["Units", "Tens", "Hundreds", "Thousands"]
  cmbfinqtygrp.List = ["Units", "Tens", "Hundreds", "Thousands"]
  cmbfinsummry.List = ["Date", "Item"]

  cmbagefir.List = ["Days", "Months", "Years"]
  cmbagelas.List = ["Days", "Months", "Years"]
  cmbwtfir.List = ["Gram", "KiloGram"]
  cmbwtlast.List = ["Gram", "KiloGram"]
  cmbgender.List = ["Yes", "No"]
  cmbtotal.List = ["Yes", "No"]
  cmbrowdate.List = ["Enable", "Disable"]

  cmbMLvar.List = ["FitsrVal", "LastVal", "First-LastVal"]

  cmbhmisproc.List = ["Billing", "Service"]
  cmbhmisradio.List = ["Billing", "Service"]
  cmbhmisincentive.List = ["Billing", "Service"]
  cmbhmisupzero.List = ["Enable", "Disable"]

  ShowClinicalSetting()
  ShowFinancialChart()

  DisplayAgegrid()
  DisplayWtgrid()
  GetCustomGrouping()

  StatSetting()
  ShowHealthReport()
  ShowHMISSettings()

End

Public Sub Form_Close()

  modGeneralMain.RecordFormExit(Me)

End

'''--------------------------clinical -----------------------------------------
Private Sub ShowClinicalSetting()

  cmbcurve.Text = modSettings.ShowSettingFromFIle("ClinicalChart/DataCurve")
  cmbclinpoint.Text = modSettings.ShowSettingFromFIle("ClinicalChart/ShowPoints")
  cmbclinlabel.Text = modSettings.ShowSettingFromFIle("ClinicalChart/ShowLabels")
  cmbclinup.Text = modSettings.ShowSettingFromFIle("ClinicalChart/ShowUpperRange")
  cmbclinlow.Text = modSettings.ShowSettingFromFIle("ClinicalChart/ShowLowerRange")
  cmbclinormal.Text = modSettings.ShowSettingFromFIle("ClinicalChart/ShowNormalRange")
  cmbclinhour.Text = modSettings.ShowSettingFromFIle("ClinicalChart/ShowHourGrid")
  cmbclindaylabel.Text = modSettings.ShowSettingFromFIle("ClinicalChart/ShowGridLabel")

  If modSettings.ShowSettingFromFIle("ClinicalChart/ShowData_Color") Then
    coldatacurve.Value = CInt(modSettings.ShowSettingFromFIle("ClinicalChart/ShowData_Color"))
  Endif
  If modSettings.ShowSettingFromFIle("ClinicalChart/ShowPoints_Color") Then
    colclinpoint.Value = CInt(modSettings.ShowSettingFromFIle("ClinicalChart/ShowPoints_Color"))
  Endif
  If modSettings.ShowSettingFromFIle("ClinicalChart/ShowLabels_Color") Then
    colclinlabel.Value = CInt(modSettings.ShowSettingFromFIle("ClinicalChart/ShowLabels_Color"))
  Endif
  If modSettings.ShowSettingFromFIle("ClinicalChart/ShowUpperRange_Color") Then
    colclinup.Value = CInt(modSettings.ShowSettingFromFIle("ClinicalChart/ShowUpperRange_Color"))
  Endif
  If modSettings.ShowSettingFromFIle("ClinicalChart/ShowLowerRange_Color") Then
    colclinlow.Value = CInt(modSettings.ShowSettingFromFIle("ClinicalChart/ShowLowerRange_Color"))
  Endif
  If modSettings.ShowSettingFromFIle("ClinicalChart/ShowNormalRange_Color") Then
    colclinormal.Value = CInt(modSettings.ShowSettingFromFIle("ClinicalChart/ShowNormalRange_Color"))
  Endif
  If modSettings.ShowSettingFromFIle("ClinicalChart/ShowHourGrid_Color") Then
    colclinhour.Value = CInt(modSettings.ShowSettingFromFIle("ClinicalChart/ShowHourGrid_Color"))
  Endif
  If modSettings.ShowSettingFromFIle("ClinicalChart/ShowDayGrid_Color") Then
    colclinday.Value = CInt(modSettings.ShowSettingFromFIle("ClinicalChart/ShowDayGrid_Color"))
  Endif
  If modSettings.ShowSettingFromFIle("ClinicalChart/ShowGridLabel_Color") Then
    colclindaylabel.Value = CInt(modSettings.ShowSettingFromFIle("ClinicalChart/ShowGridLabel_Color"))
  Endif

  ''hour diff
  If modSettings.ShowSettingFromFIle("ClinicalChart/HourDifference") Then
    txthrdiff.Value = CInt(modSettings.ShowSettingFromFIle("ClinicalChart/HourDifference"))
  Endif

End

Public Sub btndatacurve_Click()

  modSettings.SaveSettingsToFile("ClinicalChart/DataCurve", cmbcurve.Text)
  modBasic.$ClinChartDataCurve = cmbcurve.Text
  modSettings.SaveSettingsToFile("ClinicalChart/ShowData_Color", coldatacurve.Value)
  modBasic.$ClinColorData = coldatacurve.Value
  Balloon.Info(("Information saved"), btndatacurve)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnclinpoint_Click()

  modSettings.SaveSettingsToFile("ClinicalChart/ShowPoints", cmbclinpoint.Text)
  modBasic.$ClinChartShowPoint = cmbclinpoint.Text
  modSettings.SaveSettingsToFile("ClinicalChart/ShowPoints_Color", colclinpoint.Value)
  modBasic.$ClinColorPoints = colclinpoint.Value
  Balloon.Info(("Information saved"), btnclinpoint)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnclinlabel_Click()

  modSettings.SaveSettingsToFile("ClinicalChart/ShowLabels", cmbclinlabel.Text)
  modBasic.$ClinChartShowLabel = cmbclinlabel.Text
  modSettings.SaveSettingsToFile("ClinicalChart/ShowLabels_Color", colclinlabel.Value)
  modBasic.$ClinColorLabel = colclinlabel.Value
  Balloon.Info(("Information saved"), btnclinlabel)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnclinup_Click()

  modSettings.SaveSettingsToFile("ClinicalChart/ShowUpperRange", cmbclinup.Text)
  modBasic.$ClinChartShowUpper = cmbclinup.Text
  modSettings.SaveSettingsToFile("ClinicalChart/ShowUpperRange_Color", colclinup.Value)
  modBasic.$ClinColorUpper = colclinup.Value
  Balloon.Info(("Information saved"), btnclinup)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnclinlow_Click()

  modSettings.SaveSettingsToFile("ClinicalChart/ShowLowerRange", cmbclinlow.Text)
  modBasic.$ClinChartShowLower = cmbclinlow.Text
  modSettings.SaveSettingsToFile("ClinicalChart/ShowLowerRange_Color", colclinlow.Value)
  modBasic.$ClinColorLower = colclinlow.Value
  Balloon.Info(("Information saved"), btnclinlow)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnclinormal_Click()

  modSettings.SaveSettingsToFile("ClinicalChart/ShowNormalRange", cmbclinormal.Text)
  modBasic.$ClinChartShowNormal = cmbclinormal.Text
  modSettings.SaveSettingsToFile("ClinicalChart/ShowNormalRange_Color", colclinormal.Value)
  modBasic.$ClinColorNormal = colclinormal.Value
  Balloon.Info(("Information saved"), btnclinormal)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnclinhour_Click()

  modSettings.SaveSettingsToFile("ClinicalChart/ShowHourGrid", cmbclinhour.Text)
  modBasic.$ClinChartShowHourGrid = cmbclinhour.Text
  modSettings.SaveSettingsToFile("ClinicalChart/ShowHourGrid_Color", colclinhour.Value)
  modBasic.$ClinColorHourGrid = colclinhour.Value
  modSettings.SaveSettingsToFile("ClinicalChart/ShowDayGrid_Color", colclinday.Value)
  modBasic.$ClinColorDayGrid = colclinday.Value
  Balloon.Info(("Information saved"), btnclinhour)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnclindaylabel_Click()

  modSettings.SaveSettingsToFile("ClinicalChart/ShowGridLabel", cmbclindaylabel.Text)
  modBasic.$ClinChartShowGridLabel = cmbclindaylabel.Text
  modSettings.SaveSettingsToFile("ClinicalChart/ShowGridLabel_Color", colclindaylabel.Value)
  modBasic.$ClinColorGridLabel = colclindaylabel.Value
  Balloon.Info(("Information saved"), btnclindaylabel)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnhrdiff_Click()

  modSettings.SaveSettingsToFile("ClinicalChart/HourDifference", CStr(txthrdiff.Value))
  modBasic.$ClinChartHourDiff = txthrdiff.Value
  Balloon.Info(("Information saved"), btnhrdiff)
  Balloon.Delay = modBasic.$BalloonDelay

End

''----------------------------------- financial chart ------------------------------------------------
Private Sub ShowFinancialChart()

  cmbfintitle.Text = modSettings.ShowSettingFromFIle("InventoryChart/ShowTitle")
  cmbfinxlabel.Text = modSettings.ShowSettingFromFIle("InventoryChart/ShowXLabel")
  cmbfinylabel.Text = modSettings.ShowSettingFromFIle("InventoryChart/ShowYLabel")
  cmbchartday.Text = modSettings.ShowSettingFromFIle("InventoryChart/DataGrouping")
  cmbfinqtygrp.Text = modSettings.ShowSettingFromFIle("InventoryChart/QTYGrouping")
  cmbfinamtgrp.Text = modSettings.ShowSettingFromFIle("InventoryChart/AMTGrouping")
  cmbfinsummry.Text = modSettings.ShowSettingFromFIle("InventoryChart/SummaryBy")
  If modSettings.ShowSettingFromFIle("InventoryChart/ChartColor") Then
    clrchartcolor.Value = modSettings.ShowSettingFromFIle("InventoryChart/ChartColor")
  Endif
  cmbfinstat.Text = modSettings.ShowSettingFromFIle("InventoryChart/Statistics")

  If modSettings.ShowSettingFromFIle("InventoryChart/ChartLeft") Then
    txtleftval.Value = CInt(modSettings.ShowSettingFromFIle("InventoryChart/ChartLeft"))
  Endif
  If modSettings.ShowSettingFromFIle("InventoryChart/ChartTop") Then
    txttopval.Value = CInt(modSettings.ShowSettingFromFIle("InventoryChart/ChartTop"))
  Endif
  If modSettings.ShowSettingFromFIle("InventoryChart/ChartRight") Then
    txtrightval.Value = CInt(modSettings.ShowSettingFromFIle("InventoryChart/ChartRight"))
  Endif
  If modSettings.ShowSettingFromFIle("InventoryChart/ChartBottom") Then
    txtbottomval.Value = CInt(modSettings.ShowSettingFromFIle("InventoryChart/ChartBottom"))
  Endif

End

Public Sub btnfintitle_Click()

  modSettings.SaveSettingsToFile("InventoryChart/ShowTitle", cmbfintitle.Text)
  modBasic.$InvChShowTitle = cmbfintitle.Text
  Balloon.Info(("Information saved"), btnfintitle)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnfinxlabel_Click()

  modSettings.SaveSettingsToFile("InventoryChart/ShowXLabel", cmbfinxlabel.Text)
  modBasic.$InvChShowXLabel = cmbfinxlabel.Text
  Balloon.Info(("Information saved"), btnfinxlabel)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnfinylabel_Click()

  modSettings.SaveSettingsToFile("InventoryChart/ShowYLabel", cmbfinylabel.Text)
  modBasic.$InvChShowYLabel = cmbfinylabel.Text
  Balloon.Info(("Information saved"), btnfinylabel)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnchartday_Click()

  modSettings.SaveSettingsToFile("InventoryChart/DataGrouping", cmbchartday.Text)
  modBasic.$InvChDataGrouping = cmbchartday.Text
  Balloon.Info(("Information saved"), btnchartday)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnfinqtygrp_Click()

  modSettings.SaveSettingsToFile("InventoryChart/QTYGrouping", cmbfinqtygrp.Text)
  modBasic.$InvChQTYGrouping = cmbfinqtygrp.Text
  Balloon.Info(("Information saved"), btnfinqtygrp)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnfinamtgrp_Click()

  modSettings.SaveSettingsToFile("InventoryChart/AMTGrouping", cmbfinamtgrp.Text)
  modBasic.$InvChAMTGrouping = cmbfinamtgrp.Text
  Balloon.Info(("Information saved"), btnfinamtgrp)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnchartcolor_Click()

  modSettings.SaveSettingsToFile("InventoryChart/ChartColor", clrchartcolor.Value)
  Balloon.Info(("Information saved"), btnchartcolor)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnfinstat_Click()

  modSettings.SaveSettingsToFile("InventoryChart/Statistics", cmbfinstat.Text)
  modBasic.$ChartExecStat = cmbfinstat.Text
  Balloon.Info(("Information saved"), btnfinstat)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnfinsummry_Click()

  modSettings.SaveSettingsToFile("InventoryChart/SummaryBy", cmbfinsummry.Text)
  modBasic.$ChartSummaryFormat = cmbfinsummry.Text
  Balloon.Info(("Information saved"), btnfinsummry)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnset_Click()

  modSettings.SaveSettingsToFile("InventoryChart/ChartLeft", CStr(txtleftval.Value))
  modSettings.SaveSettingsToFile("InventoryChart/ChartTop", CStr(txttopval.Value))
  modSettings.SaveSettingsToFile("InventoryChart/ChartRight", CStr(txtrightval.Value))
  modSettings.SaveSettingsToFile("InventoryChart/ChartBottom", CStr(txtbottomval.Value))
  modBasic.ResizeInventoryChartSet()
  Balloon.Info(("Information saved"), btnset)
  Balloon.Delay = modBasic.$BalloonDelay

End

''----------------- Custom grouping --------------
Private Sub GetCustomGrouping()

  modSettings.ShowCheckBox(chkagegrpcustom, "AgeGrouping/Custom")
  modSettings.ShowCheckBox(chkwtgrpcustom, "WeightGrouping/Custom")

End

Public Sub btnagegrpcustom_Click()

  modSettings.EnterCheckSetting(chkagegrpcustom, "AgeGrouping/Custom")
  Balloon.Info(("Information saved"), btnagegrpcustom)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnwtgrpcustom_Click()

  modSettings.EnterCheckSetting(chkwtgrpcustom, "WeightGrouping/Custom")
  Balloon.Info(("Information saved"), btnwtgrpcustom)
  Balloon.Delay = modBasic.$BalloonDelay

End

'''-------------------------------------------------- Age Grouping -----------------------------
Public Sub btnageadd_Click()

  Dim xx As String
  Dim xfir As String
  Dim xlas As String

  If txtagegroup.Text Then
    If Not Exist(modHelpVariable.AppDirectory &/ "agegrouping") Then
      File.Save(modHelpVariable.AppDirectory &/ "agegrouping", "")
    Endif
    xx = File.Load(modHelpVariable.AppDirectory &/ "agegrouping")

    If cmbagefir.Text = "Months" Then
      xfir = CStr(CInt(txtagefir.Value * 30))
    Else If cmbagefir.Text = "Years" Then
      xfir = CStr(CInt(txtagefir.Value * 365))
    Else
      xfir = CStr(CInt(txtagefir.Value))
    Endif

    If cmbagelas.Text = "Months" Then
      xlas = CStr(CInt(txtagelas.Value * 30))
    Else If cmbagelas.Text = "Years" Then
      xlas = CStr(CInt(txtagelas.Value * 365))
    Else
      xlas = CStr(CInt(txtagelas.Value))
    Endif

    xx = xx & txtagegroup.Text & ";" & xfir & ";" & xlas & gb.NewLine
    If Exist(modHelpVariable.AppDirectory &/ "agegrouping") Then
      Kill modHelpVariable.AppDirectory &/ "agegrouping"
    Endif
    File.Save(modHelpVariable.AppDirectory &/ "agegrouping", xx)
    DisplayAgegrid()
  Endif

End

Public Sub btnagegrprefresh_Click()

  DisplayAgegrid()

End

Private Sub DisplayAgegrid()

  Dim sline As String
  Dim sCol As String[]
  Dim Row As Integer

  If Exist(modHelpVariable.AppDirectory &/ "agegrouping") Then
    GridView1.Clear
    GridView1.Columns.Count = 3
    GridView1.Rows.Count = modString.GetLineInTextFile(modHelpVariable.AppDirectory &/ "agegrouping")
    $ageFile = Open modHelpVariable.AppDirectory &/ "agegrouping"
    modBasic.DebugString("Open File " & modHelpVariable.AppDirectory &/ "agegrouping")

    Row = 0
    For Each sline In $ageFile.Lines
      sCol = Split(sLine, ";")
      GridView1[Row, 0].Text = sCol[0]
      GridView1[Row, 1].Text = sCol[1]
      GridView1[Row, 2].Text = sCol[2]
      Row = Row + 1
    Next
    $ageFile.Close()

    With GridView1
      .Columns[0].Text = "Age Group Label"
      .Columns[1].Text = "Min age (Days)"
      .Columns[2].Text = "Max age(Days)"
      .Columns[0].Width = 250 * modBasic.$AppWidthRatio
      .Columns[1].Width = 150 * modBasic.$AppWidthRatio
      .Columns[2].Width = 150 * modBasic.$AppWidthRatio
    End With
  Else
    GridView1.Clear
  Endif

End

Public Sub btnagerefresh_Click()

  Dim sPath As String

  sPath = modHelpVariable.AppDirectory &/ "agegrouping"
  If Exist(sPath) Then
    modDevice.DesktopOpenFile(sPath)
  Endif

End

Public Sub btnclear_Click()

  Dim sPath As String

  sPath = modHelpVariable.AppDirectory &/ "agegrouping"
  If Exist(sPath) Then
    Kill sPath
  Endif

End

'''-------------------------------------------------- Weight Grouping -----------------------------
Public Sub cmbwtadd_Click()

  Dim xx As String
  Dim xfir As String
  Dim xlas As String

  If txtwtgroup.Text Then
    If Not Exist(modHelpVariable.AppDirectory &/ "weightgrouping") Then
      File.Save(modHelpVariable.AppDirectory &/ "weightgrouping", "")
    Endif
    xx = File.Load(modHelpVariable.AppDirectory &/ "weightgrouping")

    If cmbwtfir.Text = "KiloGram" Then
      xfir = CStr(txtwtfir.Value * 1000)
    Else
      xfir = CStr(txtwtfir.Value)
    Endif

    If cmbwtlast.Text = "KiloGram" Then
      xlas = CStr(txtwtlast.Value * 1000)
    Else
      xlas = CStr(txtwtlast.Value)
    Endif

    xx = xx & txtwtgroup.Text & ";" & xfir & ";" & xlas & gb.NewLine
    If Exist(modHelpVariable.AppDirectory &/ "weightgrouping") Then
      Kill modHelpVariable.AppDirectory &/ "weightgrouping"
    Endif
    File.Save(modHelpVariable.AppDirectory &/ "weightgrouping", xx)
    DisplayWtgrid()
  Endif

End

Public Sub btnwtgrprefresh_Click()

  DisplayWtgrid()

End

Private Sub DisplayWtgrid()

  Dim sline As String
  Dim sCol As String[]
  Dim Row As Integer

  If Exist(modHelpVariable.AppDirectory &/ "weightgrouping") Then
    GridView2.Clear
    GridView2.Columns.Count = 3
    GridView2.Rows.Count = modString.GetLineInTextFile(modHelpVariable.AppDirectory &/ "weightgrouping")
    $ageFile = Open modHelpVariable.AppDirectory &/ "weightgrouping"
    modBasic.DebugString("Open File " & modHelpVariable.AppDirectory &/ "weightgrouping")

    Row = 0
    For Each sline In $ageFile.Lines
      sCol = Split(sLine, ";")
      GridView2[Row, 0].Text = sCol[0]
      GridView2[Row, 1].Text = sCol[1]
      GridView2[Row, 2].Text = sCol[2]
      Row = Row + 1
    Next
    $ageFile.Close()

    With GridView2
      .Columns[0].Text = "Wt Group Label"
      .Columns[1].Text = "Min Wt (Gram)"
      .Columns[2].Text = "Max Wt (Gram)"
      .Columns[0].Width = 250 * modBasic.$AppWidthRatio
      .Columns[1].Width = 150 * modBasic.$AppWidthRatio
      .Columns[2].Width = 150 * modBasic.$AppWidthRatio
    End With

  Else
    GridView2.Clear
  Endif

End

Public Sub btnwtrefresh_Click()

  Dim sPath As String

  sPath = modHelpVariable.AppDirectory &/ "weightgrouping"
  If Exist(sPath) Then
    modDevice.DesktopOpenFile(sPath)
  Endif

End

''---------------------------------- Health Report ---------------------------
Private Sub ShowHealthReport()

  cmbgender.Text = modSettings.ShowSettingFromFIle("HealthReport/ShowGender")
  cmbtotal.Text = modSettings.ShowSettingFromFIle("HealthReport/ShowTotal")
  cmbrowdate.Text = modSettings.ShowSettingFromFIle("HealthReport/RowDateFormat")

End

Public Sub btngender_Click()

  modSettings.SaveSettingsToFile("HealthReport/ShowGender", cmbgender.Text)
  Balloon.Info(("Information saved"), btngender)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btntotal_Click()

  modSettings.SaveSettingsToFile("HealthReport/ShowTotal", cmbtotal.Text)
  Balloon.Info(("Information saved"), btntotal)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnrowdate_Click()

  modSettings.SaveSettingsToFile("HealthReport/RowDateFormat", cmbrowdate.Text)
  Balloon.Info(("Information saved"), btnrowdate)
  Balloon.Delay = modBasic.$BalloonDelay

End

''------------------------------------- Statistical Settings -------------------------
Private Sub StatSetting()

  If modSettings.ShowSettingFromFIle("StatisticsSetting/ConfidenceInterval") Then
    txtconfinterval.Value = modSettings.ShowSettingFromFIle("StatisticsSetting/ConfidenceInterval")
  Endif
  cmbMLvar.Text = modSettings.ShowSettingFromFIle("StatisticsSetting/ClinicalValues")

End

Public Sub btnconfinterval_Click()

  modSettings.SaveSettingsToFile("StatisticsSetting/ConfidenceInterval", CStr(txtconfinterval.Value))
  modBasic.$StatConfInterval = txtconfinterval.Value
  Balloon.Info(("Information saved"), btnconfinterval)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnMLvar_Click()

  modSettings.SaveSettingsToFile("StatisticsSetting/ClinicalValues", cmbMLvar.Text)
  modBasic.$StatClinValues = cmbMLvar.Text
  Balloon.Info(("Information saved"), btnMLvar)
  Balloon.Delay = modBasic.$BalloonDelay

End

''----------------------- HMIS setting -------------------
Private Sub ShowHMISSettings()

  cmbhmisradio.Text = modSettings.ShowSettingFromFIle("HMISReporting/RadiologySource")
  cmbhmisproc.Text = modSettings.ShowSettingFromFIle("HMISReporting/ProcedureSource")
  cmbhmisincentive.Text = modSettings.ShowSettingFromFIle("HMISReporting/IncentiveSource")
  cmbhmisupzero.Text = modSettings.ShowSettingFromFIle("HMISReporting/UploadZero")

End

Public Sub btnhmisradio_Click()

  modSettings.SaveSettingsToFile("HMISReporting/RadiologySource", cmbhmisradio.Text)
  Balloon.Info(("Information saved"), btnhmisradio)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnhmisproc_Click()

  modSettings.SaveSettingsToFile("HMISReporting/ProcedureSource", cmbhmisproc.Text)
  Balloon.Info(("Information saved"), btnhmisproc)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnhmisincentive_Click()

  modSettings.SaveSettingsToFile("HMISReporting/IncentiveSource", cmbhmisincentive.Text)
  Balloon.Info(("Information saved"), btnhmisincentive)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnhmisupzero_Click()

  modSettings.SaveSettingsToFile("HMISReporting/UploadZero", cmbhmisupzero.Text)
  Balloon.Info(("Information saved"), btnhmisupzero)
  Balloon.Delay = modBasic.$BalloonDelay

End
