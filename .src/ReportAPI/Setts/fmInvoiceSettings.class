' Gambas class file

Private $xList As String[]

Public Sub Form_Open()

  modGeneralMain.ArrangeFormCentre(Me)

  $xList = modNonMedical.FillCashModeCombo()
  $xList.Insert(["All", "None"])

  'formating
  cmbatch.List = ["Yes", "No"]
  cmbqty.List = ["Yes", "No"]
  cmbcategory.List = ["Yes", "No"]
  cmbshowtaxdisc.List = ["Always", "NotNull", "DiscOnly"]
  cmbdiscformat.List = ["Percent", "Amount"]
  cmbtaxformat.List = ["Percent", "Amount"]
  cmbcashcredit.List = ["Percent", "Amount"]
  cmbtaxsum.List = ["Always", "NotNull", "None"]
  cmbdiscsum.List = ["Always", "NotNull", "None"]
  cmbitemsuffix.List = ["Payable", "Referral", "Components", "None"]
  cmbmed.List = ["Brand", "Generic", "Both"]
  cmbdate.List = ["AD Date", "BS Date"]
  cmbgroupitem.List = ["Amount", "Category", "Group", "None"]
  cmbexpiry.List = ["mmm dd yyyy", "dd mmm yyyy", "dd-mm-yyyy", "mmm yyyy", "mm-yyyy", "No"]
  cmblocation.List = ["Comp ID", "Department"]
  cmbextrabill.List = ["Print", "Print+Print", "Save", "Print+Save", "None"]
  cmbextrefer.List = ["Yes", "No"]
  cmbregdslip.List = ["Sticker", "Prescription", "None"]
  cmbdischbill.List = ["Summary", "Detail"]
  cmbskiprint.List = ["Registration", "Discharge"]
  cmbitmselct.List = ["Current", "Multiple"]
  cmbshowMRP.List = ["Yes", "No"]

  ShowPrintingParam()

End

Public Sub Form_Close()

  modGeneralMain.RecordFormExit(Me)

End

Public Sub IconPanel1_Click()

  If IconPanel1.Index = 1 Then
    'title
    cmblogo.List = ["Yes", "No"]
    cmbhosp.List = ["Yes", "No"]
    cmbdept.List = ["Yes", "No"]
    cmbaddress.List = ["Yes", "No"]
    cmbinvtypealign.List = AlignmentList()
    cmbportalqrform.List = ["Archive:All Categories", "Archive:Diagnostic Tests", "Archive:Radio Diagnostics", "Archive:General Reports", "Archive:Patient Portal"]
    cmbnullinvoice.List = modMisc.CustomReportList()
    ShowHeaderSett()
    ShowEndNote()

  Else If IconPanel1.Index = 2 Then
    cmblinheadcol11.List = HeaderList()
    cmblinheadcol12.List = HeaderList()
    cmblinheadcol21.List = HeaderList()
    cmblinheadcol22.List = HeaderList()
    cmblinheadcol31.List = HeaderList()
    cmblinheadcol32.List = HeaderList()

    cmblinfootcol11.List = FooterList()                       ''
    cmblinfootcol12.List = FooterList()
    cmblinfootcol21.List = FooterList()
    cmblinfootcol22.List = FooterList()
    cmblinfootcol31.List = FooterList()
    cmblinfootcol32.List = FooterList()
    cmblinfootcol41.List = FooterList()
    cmblinfootcol42.List = FooterList()

    cmblinfootcol11a.List = FooterList()                       ''
    cmblinfootcol12a.List = FooterList()
    cmblinfootcol21a.List = FooterList()
    cmblinfootcol22a.List = FooterList()
    cmblinfootcol31a.List = FooterList()
    cmblinfootcol32a.List = FooterList()
    cmblinfootcol41a.List = FooterList()
    cmblinfootcol42a.List = FooterList()

    cmblinefootend1.List = FooterList()
    cmblinefootend2.List = FooterList()
    cmblinefootendcol1.List = FooterList()
    cmblinefootendcol2.List = FooterList()

    SHowLineHeader()
    SHowLineFooter()
    SHowLineFooteCash()
    FooterEndLines()

  Else If IconPanel1.Index = 3 Then
    cmbtablelabel.List = ["Yes", "No"]
    cmbhidetable.List = ["Yes", "No"]
    cmbcolwid1.List = ["%", "px"]
    cmbcolwid2.List = ["%", "px"]
    cmbcolwid3.List = ["%", "px"]
    cmbcolwid4.List = ["%", "px"]
    cmbcolwid5.List = ["%", "px"]
    cmbcolwid6.List = ["%", "px"]

    cmbcolalign1.List = AlignmentList()
    cmbcolalign2.List = AlignmentList()
    cmbcolalign3.List = AlignmentList()
    cmbcolalign4.List = AlignmentList()
    cmbcolalign5.List = AlignmentList()
    cmbcolalign6.List = AlignmentList()
    cmbcolalign7.List = AlignmentList()
    cmbcolalign8.List = AlignmentList()

    cmbheadtablelabelalign.List = AlignmentList()
    cmbheadtabletextalign.List = AlignmentList()
    cmbfoottablelabelalign.List = AlignmentList()
    cmbfoottabletextalign.List = AlignmentList()
    cmbheadlabelwidth.List = ["%", "px"]
    cmbheadtextwidth.List = ["%", "px"]
    cmbfootlabelwidth.List = ["%", "px"]
    cmbfoottextwidth.List = ["%", "px"]

    HeaderTableSetting()
    FooterTableSetting()
    ShowTitleLabelSett()
    ShowColumnWidthSett()

  Else If IconPanel1.Index = 4 Then
    cmbinvoiceorient.List = ["Portrait", "Landscape"]
    cmbPDFbackground.List = ["Yes", "No"]
    cmbPDFImage.List = ["Yes", "No"]
    cmbPDFrotate.List = ["90", "180", "270", "None"]
    cmbPDpapsize.List = ["A3", "A4", "A5", "B3", "B4", "B5", "Letter", "Legal", "Tabloid"]
    cmbhtmlform.List = ["Yes", "No"]
    cmbhtmllink.List = ["Yes", "No"]
    cmbgrayscale.List = ["Yes", "No"]
    cmbinternalink.List = ["Yes", "No"]
    cmbPDFshrink.List = ["Enable", "Disable", "None"]
    cmblowquality.List = ["Enable", "Disable"]
    ShowInvoicePDF()
    GeneralPDFDesign()

  Else If IconPanel1.Index = 5 Then
    cmbpdfootline.List = ["Yes", "No"]
    cmbpdfootsource.List = ["Text", "HTML", "None"]
    PDFFooterDesign()

  Else If IconPanel1.Index = 6 Then
    cmbpdfheadline.List = ["Yes", "No"]
    cmbpdfheadsource.List = ["Text", "HTML", "None"]
    PDFHeaderDesign()

  Else If IconPanel1.Index = 7 Then
    cmblinetabletitle.List = ["Yes", "No"]

    txtline_align1.List = AlignmentList()
    txtline_align2.List = AlignmentList()
    txtline_align3.List = AlignmentList()
    txtline_align4.List = AlignmentList()
    txtline_align5.List = AlignmentList()
    txtline_align6.List = AlignmentList()
    txtline_align7.List = AlignmentList()
    txtline_align8.List = AlignmentList()

    txtline_headalign1.List = AlignmentList()
    txtline_headalign2.List = AlignmentList()
    txtline_footalign1.List = AlignmentList()
    txtline_footalign2.List = AlignmentList()

    ShowLineFormaTable()
    LinePrintColwidth()

  Else If IconPanel1.Index = 8 Then
    cmblinepageformat.List = ["Continuous", "Discrete"]

    ShowInvBlankLine()
    LinePageFormatSetting()

  Else If IconPanel1.Index = 9 Then
    cmbcontitle.List = ["BuiltIn", "External"]
    cmbconheader.List = ["BuiltIn", "External"]
    cmbcontable.List = ["BuiltIn", "External"]
    cmbconfooter.List = ["BuiltIn", "External"]
    cmbinvconversion.List = ["HTML", "Text"]

    cmbeditax.List = ["Percent", "Amount"]
    cmbwarncredit.List = ["Yes", "No"]
    cmbbillalert.List = ["Patient No", "Patient Code", "Data Repo", "None"]
    cmbnoregimen.List = ["Enable", "Disable"]
    cmbautopayble.List = $xList
    cmbautocalc.List = ["Calculator", "InvoiceInfo", "BlankForm"]
    cmbdefitemtype.List = ["All", "Test", "Service", "Procedure", "Equipment", "Radio", "Others", "Package", "Group", "No Change"]
    cmbdefpharmtype.List = modMedicine.AllComboRoute()
    cmbdefpharmtype.Add("No Change")

    ShowDefaultComponent()
    ShowLineSpacing()
    GeneralBillSetting()

  Else If IconPanel1.Index = 10 Then
    CBMSSetting()
    SetQRCodeParam()

  Endif

End

Private Function HeaderList() As String[]

  Dim xx As String[]

  xx = ["{PatientName}", "{Encounter}", "{InvoiceType}", "{InvoiceMode}", "{InvoiceNumber}", "{LedgerA/C}", "{InvRefNumber}", "{BillPrintCount}", "{BillDateTime}", "{BillUser}", "{PatientNo}", "{PatientCode}", "{PatientAddress}", "{PatientDistrict}", "{PatientGender}", "{PatientGuardian}", "{PatientDOB}", "{PatientAge}", "{AgeGroup}", "{AgeGroupCustom}", "{E-Mail}", "{ContactNo}", "{Age/Sex}", "{RegdBillMode}", "{ReferLabel}", "{PayableLabel}", "{ReturnBillNo}", "{ReturnReason}", "{DiscountTag}", "{CurrentDeposit}", "{NonInvoicedExpenses}", "{BalanceDeposit}", "{PatientBarCode}", "{PatientQRCode}", "{PatientImage}", "{ReturnDiscCode}", "{ReturnTaxCode}"]                                             ''
  Return xx

End

Private Function FooterList() As String[]

  Dim xx As String[]

  xx = ["{SubTotal}", "{Discount}", "{DiscountGroup}", "{TaxableAmt}", "{TotalTax}", "{TaxGroup}", "{TotalAmount}", "{ReceAmount}", "{AmtWord}", "{DueCredit}", "{DueAmount}", "{BillDateTime}", "{BillUser}", "{Note1}", "{NoteII}"]                                                 ''
  Return xx

End

Private Function AlignmentList() As String[]

  Dim xx As String[]

  xx = ["left", "center", "right"]
  Return xx

End

''------------------------------------------------------------------------------------------
Public Sub btncbmssave_Click()

  If txtcbmsuser.Text Then
    modSettings.SaveSettingsToFile("CBMSAPI/UserName", Base64(txtcbmsuser.Text))
  Endif
  If txtcbmspass.Text Then
    modSettings.SaveSettingsToFile("CBMSAPI/Password", Base64(txtcbmspass.Text))
  Endif
  modSettings.SaveSettingsToFile("CBMSAPI/SalesURL", txtcbmsapi.Text)
  modSettings.SaveSettingsToFile("CBMSAPI/ReturnURL", txtcbmsapiret.Text)
  Balloon.Info(("Information saved"), btncbmssave)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub txtcbmsapi_Click()

  txtcbmsapi.Text = "https://cbapi.ird.gov.np/api/bill"

End

Public Sub txtcbmsapiret_Click()

  txtcbmsapiret.Text = "https://cbapi.ird.gov.np/api/billreturn"

End

Private Sub CBMSSetting()

  If modSettings.ShowSettingFromFIle("CBMSAPI/UserName") Then
    txtcbmsuser.Text = UnBase64(modSettings.ShowSettingFromFIle("CBMSAPI/UserName"))
  Endif
  If modSettings.ShowSettingFromFIle("CBMSAPI/Password") Then
    txtcbmspass.Text = UnBase64(modSettings.ShowSettingFromFIle("CBMSAPI/Password"))
  Endif
  txtcbmsapi.Text = modSettings.ShowSettingFromFIle("CBMSAPI/SalesURL")
  txtcbmsapiret.Text = modSettings.ShowSettingFromFIle("CBMSAPI/ReturnURL")

End

''---------------------- Qr Code -------------------
Private Sub SetQRCodeParam()

  txtqrcodeshellpath.Text = modSettings.ShowSettingFromFIle("Invoice/QRCodeScript")
  txtqrcodeshellname.Text = modSettings.ShowSettingFromFIle("Invoice/QRCodeShell")

End

Public Sub btnqrcodeshellset_Click()

  modSettings.SaveSettingsToFile("Invoice/QRCodeScript", txtqrcodeshellpath.Text)
  modSettings.SaveSettingsToFile("Invoice/QRCodeShell", txtqrcodeshellname.Text)
  modBasic.$QRPaymentScript = txtqrcodeshellpath.Text
  modBasic.$QRPaymentShell = txtqrcodeshellname.Text
  Balloon.Info(("Information saved"), btnqrcodeshellset)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub txtqrcodeshellpath_Click()

  If Dialog.OpenFile() Then Return
  txtqrcodeshellpath.Text = Dialog.Path

End

''---------------------------------- Formatting ----------------------------------------

Private Sub ShowPrintingParam()

  cmbatch.Text = modSettings.ShowSettingFromFIle("Invoice/ShowBatch")
  cmbexpiry.Text = modSettings.ShowSettingFromFIle("Invoice/ShowExpiry")
  cmbqty.Text = modSettings.ShowSettingFromFIle("Invoice/ShowQuantity")
  cmbcategory.Text = modSettings.ShowSettingFromFIle("Invoice/ShowDateTime")
  cmbshowtaxdisc.Text = modSettings.ShowSettingFromFIle("Invoice/ShowTaxDisc")
  cmbdiscformat.Text = modSettings.ShowSettingFromFIle("Invoice/DiscountFormat")
  cmbtaxformat.Text = modSettings.ShowSettingFromFIle("Invoice/TaxFormat")
  cmbcashcredit.Text = modSettings.ShowSettingFromFIle("Invoice/CashCreditFormat")
  cmbtaxsum.Text = modSettings.ShowSettingFromFIle("Invoice/ShowSumTax")
  cmbdiscsum.Text = modSettings.ShowSettingFromFIle("Invoice/ShowSumDiscount")
  cmbshowMRP.Text = modSettings.ShowSettingFromFIle("Invoice/ShowMaxRetailPrice")

  cmbmed.Text = modSettings.ShowSettingFromFIle("Invoice/MedicineName")
  cmbitemsuffix.Text = modSettings.ShowSettingFromFIle("Invoice/ParticularSuffix")
  cmbdate.Text = modSettings.ShowSettingFromFIle("Invoice/DateFormat")
  cmbgroupitem.Text = modSettings.ShowSettingFromFIle("Invoice/GroupItem")
  cmblocation.Text = modSettings.ShowSettingFromFIle("Invoice/BillingLocation")

  cmbextrabill.Text = modSettings.ShowSettingFromFIle("Invoice/ExtraCopy")
  cmbextrefer.Text = modSettings.ShowSettingFromFIle("Invoice/EnableExtraLabel")
  cmbregdslip.Text = modSettings.ShowSettingFromFIle("Invoice/PostInvoicePrint")
  cmbdischbill.Text = modSettings.ShowSettingFromFIle("Invoice/DischargeBillFormat")
  cmbskiprint.Text = modSettings.ShowSettingFromFIle("Invoice/SkipInvoicePrinting")
  cmbitmselct.Text = modSettings.ShowSettingFromFIle("Invoice/PharmacySelection")

End

Public Sub btnvarbatch_Click()

  modSettings.SaveSettingsToFile("Invoice/ShowBatch", cmbatch.Text)
  Balloon.Info(("Information saved"), btnvarbatch)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnvarexpiry_Click()

  modSettings.SaveSettingsToFile("Invoice/ShowExpiry", cmbexpiry.Text)
  modBasic.$BillExpiryFormat = cmbexpiry.Text
  Balloon.Info(("Information saved"), btnvarexpiry)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnvarqty_Click()

  modSettings.SaveSettingsToFile("Invoice/ShowQuantity", cmbqty.Text)
  Balloon.Info(("Information saved"), btnvarqty)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btncategory_Click()

  modSettings.SaveSettingsToFile("Invoice/ShowDateTime", cmbcategory.Text)
  Balloon.Info(("Information saved"), btncategory)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnvarmed_Click()

  modSettings.SaveSettingsToFile("Invoice/MedicineName", cmbmed.Text)
  modBasic.$BillMedicineFormat = cmbmed.Text
  Balloon.Info(("Information saved"), btnvarmed)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnvardate_Click()

  modSettings.SaveSettingsToFile("Invoice/DateFormat", cmbdate.Text)
  Balloon.Info(("Information saved"), btnvardate)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btndiscformat_Click()

  modSettings.SaveSettingsToFile("Invoice/DiscountFormat", cmbdiscformat.Text)
  Balloon.Info(("Information saved"), btndiscformat)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btntaxformat_Click()

  modSettings.SaveSettingsToFile("Invoice/TaxFormat", cmbtaxformat.Text)
  Balloon.Info(("Information saved"), btntaxformat)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btncashcredit_Click()

  modSettings.SaveSettingsToFile("Invoice/CashCreditFormat", cmbcashcredit.Text)
  Balloon.Info(("Information saved"), btncashcredit)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnshowtaxdisc_Click()

  modSettings.SaveSettingsToFile("Invoice/ShowTaxDisc", cmbshowtaxdisc.Text)
  Balloon.Info(("Information saved"), btnshowtaxdisc)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btndiscsum_Click()

  modSettings.SaveSettingsToFile("Invoice/ShowSumDiscount", cmbdiscsum.Text)
  Balloon.Info(("Information saved"), btndiscsum)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btntaxsum_Click()

  modSettings.SaveSettingsToFile("Invoice/ShowSumTax", cmbtaxsum.Text)
  Balloon.Info(("Information saved"), btntaxsum)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnitemsuffix_Click()

  modSettings.SaveSettingsToFile("Invoice/ParticularSuffix", cmbitemsuffix.Text)
  Balloon.Info(("Information saved"), btnitemsuffix)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnvargroup_Click()

  modSettings.SaveSettingsToFile("Invoice/GroupItem", cmbgroupitem.Text)
  Balloon.Info(("Information saved"), btnvargroup)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnvarlocat_Click()

  modSettings.SaveSettingsToFile("Invoice/BillingLocation", cmblocation.Text)
  Balloon.Info(("Information saved"), btnvarlocat)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnextrabill_Click()

  modSettings.SaveSettingsToFile("Invoice/ExtraCopy", cmbextrabill.Text)
  Balloon.Info(("Information updated"), btnextrabill)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnextrefer_Click()

  modSettings.SaveSettingsToFile("Invoice/EnableExtraLabel", cmbextrefer.Text)
  Balloon.Info(("Information updated"), btnextrefer)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnregdslip_Click()

  modSettings.SaveSettingsToFile("Invoice/PostInvoicePrint", cmbregdslip.Text)
  modBasic.$BillWithInvoicePrint = cmbregdslip.Text
  Balloon.Info(("Information updated"), btnregdslip)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btndischbill_Click()

  modSettings.SaveSettingsToFile("Invoice/DischargeBillFormat", cmbdischbill.Text)
  Balloon.Info(("Information updated"), btndischbill)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnshowMRP_Click()

  modSettings.SaveSettingsToFile("Invoice/ShowMaxRetailPrice", cmbshowMRP.Text)
  Balloon.Info(("Information saved"), btnshowMRP)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnskiprint_Click()

  modSettings.SaveSettingsToFile("Invoice/SkipInvoicePrinting", cmbskiprint.Text)
  modBasic.$BillSkipPrinting = cmbskiprint.Text
  Balloon.Info(("Information updated"), btnskiprint)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnitmslct_Click()

  modSettings.SaveSettingsToFile("Invoice/PharmacySelection", cmbitmselct.Text)
  modBasic.$BillPharmSelection = cmbitmselct.Text
  Balloon.Info(("Information updated"), btnitmslct)
  Balloon.Delay = modBasic.$BalloonDelay

End

''----------------------------------------------- Extra Settings --------------------------------------------------
Private Sub GeneralBillSetting()

  cmbdefitemtype.Text = modSettings.ShowSettingFromFIle("BillingSettings/DefaultServiceType")
  cmbdefpharmtype.Text = modSettings.ShowSettingFromFIle("BillingSettings/DefaultPharmacyType")

  cmbautopayble.Text = modSettings.ShowSettingFromFIle("BillingSettings/AutoDisplayPayable")
  cmbautocalc.Text = modSettings.ShowSettingFromFIle("BillingSettings/AfterPrintAutoDisplay")
  cmbeditax.Text = modSettings.ShowSettingFromFIle("BillingSettings/EditTaxDiscount")
  cmbwarncredit.Text = modSettings.ShowSettingFromFIle("BillingSettings/PastCreditsDisplay")

  cmbbillalert.Text = modSettings.ShowSettingFromFIle("HistoryAlert/PatientCode")
  cmbnoregimen.Text = modSettings.ShowSettingFromFIle("MedicineSetting/DisableDoseRegimen")

End

Public Sub btnbillalert_Click()

  modSettings.SaveSettingsToFile("HistoryAlert/PatientCode", cmbbillalert.Text)
  modBasic.$SalesHistoryAlert = cmbbillalert.Text
  Balloon.Info(("Information saved"), btnbillalert)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnnoregimen_Click()

  modSettings.SaveSettingsToFile("MedicineSetting/DisableDoseRegimen", cmbnoregimen.Text)
  modBasic.$MedNoRegimen = cmbnoregimen.Text
  Balloon.Info(("Information saved"), btnnoregimen)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btndefitemtype_Click()

  modSettings.SaveSettingsToFile("BillingSettings/DefaultServiceType", cmbdefitemtype.Text)
  Balloon.Info(("Information updated"), btndefitemtype)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btndefpharmtype_Click()

  modSettings.SaveSettingsToFile("BillingSettings/DefaultPharmacyType", cmbdefpharmtype.Text)
  Balloon.Info(("Information updated"), btndefpharmtype)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btneditax_Click()

  modSettings.SaveSettingsToFile("BillingSettings/EditTaxDiscount", cmbeditax.Text)
  modBasic.$BillEditTaxDiscForm = cmbeditax.Text
  Balloon.Info(("Information updated"), btneditax)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnautopayble_Click()

  modSettings.SaveSettingsToFile("BillingSettings/AutoDisplayPayable", cmbautopayble.Text)
  modBasic.$BillShowAutoPayable = cmbautopayble.Text
  Balloon.Info(("Information updated"), btnautopayble)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnautocalc_Click()

  modSettings.SaveSettingsToFile("BillingSettings/AfterPrintAutoDisplay", cmbautocalc.Text)
  modBasic.$BillAfterPrintDisplay = cmbautocalc.Text
  Balloon.Info(("Information updated"), btnautocalc)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnwarncredit_Click()

  modSettings.SaveSettingsToFile("BillingSettings/PastCreditsDisplay", cmbwarncredit.Text)
  modBasic.$BillWarnCredits = cmbwarncredit.Text
  Balloon.Info(("Information updated"), btnwarncredit)
  Balloon.Delay = modBasic.$BalloonDelay

End

'''------------------- default component ----------------------------------------
Private Sub ShowDefaultComponent()

  cmbcontitle.Text = modSettings.ShowSettingFromFIle("Invoice/Default_Title")
  cmbconheader.Text = modSettings.ShowSettingFromFIle("Invoice/Default_Header")
  cmbcontable.Text = modSettings.ShowSettingFromFIle("Invoice/Default_Table")
  cmbconfooter.Text = modSettings.ShowSettingFromFIle("Invoice/Default_Footer")
  cmbinvconversion.Text = modSettings.ShowSettingFromFIle("Invoice/TextFile_Source")
  If modSettings.ShowSettingFromFIle("Invoice/HTML-to-Text_Width") Then
    txthtmltexwid.Value = CInt(modSettings.ShowSettingFromFIle("Invoice/HTML-to-Text_Width"))
  Endif

End

Public Sub btncontitle_Click()

  modSettings.SaveSettingsToFile("Invoice/Default_Title", cmbcontitle.Text)
  Balloon.Info(("Information saved"), btncontitle)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnconheader_Click()

  modSettings.SaveSettingsToFile("Invoice/Default_Header", cmbconheader.Text)
  Balloon.Info(("Information saved"), btnconheader)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btncontable_Click()

  modSettings.SaveSettingsToFile("Invoice/Default_Table", cmbcontable.Text)
  Balloon.Info(("Information saved"), btncontable)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnconfooter_Click()

  modSettings.SaveSettingsToFile("Invoice/Default_Footer", cmbconfooter.Text)
  Balloon.Info(("Information saved"), btnconfooter)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btninvconversion_Click()

  modSettings.SaveSettingsToFile("Invoice/TextFile_Source", cmbinvconversion.Text)
  Balloon.Info(("Information updated"), btninvconversion)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnhtmtexwid_Click()

  modSettings.SaveSettingsToFile("Invoice/HTML-to-Text_Width", CStr(txthtmltexwid.Value))
  Balloon.Info(("Information updated"), btnhtmtexwid)
  Balloon.Delay = modBasic.$BalloonDelay

End

''----------------------------------- spacing --------------------------------------------
Private Sub ShowLineSpacing()

  If modSettings.ShowSettingFromFIle("Invoice/BlankLines_Address_Department") Then
    txtadd_dep.Value = CInt(modSettings.ShowSettingFromFIle("Invoice/BlankLines_Address_Department"))
  Endif
  If modSettings.ShowSettingFromFIle("Invoice/BlankLines_Department_Header") Then
    txtdept_profile.Value = CInt(modSettings.ShowSettingFromFIle("Invoice/BlankLines_Department_Header"))
  Endif
  If modSettings.ShowSettingFromFIle("Invoice/BlankLines_Header_Body") Then
    txtprofile_body.Value = CInt(modSettings.ShowSettingFromFIle("Invoice/BlankLines_Header_Body"))
  Endif
  If modSettings.ShowSettingFromFIle("Invoice/BlankLines_Body_Footer") Then
    txtbody_foot.Value = CInt(modSettings.ShowSettingFromFIle("Invoice/BlankLines_Body_Footer"))
  Endif

End

Public Sub btnline1_Click()

  modSettings.SaveSettingsToFile("Invoice/BlankLines_Address_Department", CStr(txtadd_dep.Value))
  Balloon.Info(("Information saved"), btnline1)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnline2_Click()

  modSettings.SaveSettingsToFile("Invoice/BlankLines_Department_Header", CStr(txtdept_profile.Value))
  Balloon.Info(("Information saved"), btnline2)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnline3_Click()

  modSettings.SaveSettingsToFile("Invoice/BlankLines_Header_Body", CStr(txtprofile_body.Value))
  Balloon.Info(("Information saved"), btnline3)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnline4_Click()

  modSettings.SaveSettingsToFile("Invoice/BlankLines_Body_Footer", CStr(txtbody_foot.Value))
  Balloon.Info(("Information saved"), btnline4)
  Balloon.Delay = modBasic.$BalloonDelay

End

''--------------------------------------------- Extra line print------------------------------------------
Private Sub SHowLineHeader()

  txtlinheadcol11.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_HeaderLabel_Col11")
  cmblinheadcol11.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_HeaderText_Col11")

  txtlinheadcol12.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_HeaderLabel_Col12")
  cmblinheadcol12.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_HeaderText_Col12")

  txtlinheadcol21.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_HeaderLabel_Col21")
  cmblinheadcol21.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_HeaderText_Col21")

  txtlinheadcol22.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_HeaderLabel_Col22")
  cmblinheadcol22.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_HeaderText_Col22")

  txtlinheadcol31.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_HeaderLabel_Col31")
  cmblinheadcol31.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_HeaderText_Col31")

  txtlinheadcol32.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_HeaderLabel_Col32")
  cmblinheadcol32.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_HeaderText_Col32")

End

Public Sub btnlinheadcol11_Click()

  modSettings.SaveSettingsToFile("Invoice/BuiltIn_HeaderLabel_Col11", txtlinheadcol11.Text)
  modSettings.SaveSettingsToFile("Invoice/BuiltIn_HeaderText_Col11", cmblinheadcol11.Text)
  Balloon.Info(("Information updated"), btnlinheadcol11)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnlinheadcol12_Click()

  modSettings.SaveSettingsToFile("Invoice/BuiltIn_HeaderLabel_Col12", txtlinheadcol12.Text)
  modSettings.SaveSettingsToFile("Invoice/BuiltIn_HeaderText_Col12", cmblinheadcol12.Text)
  Balloon.Info(("Information updated"), btnlinheadcol12)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnlinheadcol21_Click()

  modSettings.SaveSettingsToFile("Invoice/BuiltIn_HeaderLabel_Col21", txtlinheadcol21.Text)
  modSettings.SaveSettingsToFile("Invoice/BuiltIn_HeaderText_Col21", cmblinheadcol21.Text)
  Balloon.Info(("Information updated"), btnlinheadcol21)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnlinheadcol22_Click()

  modSettings.SaveSettingsToFile("Invoice/BuiltIn_HeaderLabel_Col22", txtlinheadcol22.Text)
  modSettings.SaveSettingsToFile("Invoice/BuiltIn_HeaderText_Col22", cmblinheadcol22.Text)
  Balloon.Info(("Information updated"), btnlinheadcol22)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnlinheadcol31_Click()

  modSettings.SaveSettingsToFile("Invoice/BuiltIn_HeaderLabel_Col31", txtlinheadcol31.Text)
  modSettings.SaveSettingsToFile("Invoice/BuiltIn_HeaderText_Col31", cmblinheadcol31.Text)
  Balloon.Info(("Information updated"), btnlinheadcol31)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnlinheadcol32_Click()

  modSettings.SaveSettingsToFile("Invoice/BuiltIn_HeaderLabel_Col32", txtlinheadcol32.Text)
  modSettings.SaveSettingsToFile("Invoice/BuiltIn_HeaderText_Col32", cmblinheadcol32.Text)
  Balloon.Info(("Information updated"), btnlinheadcol32)
  Balloon.Delay = modBasic.$BalloonDelay

End

''----------------------------------------------- Line footer cash ------------------------------
Private Sub SHowLineFooteCash()

  txtlinfootcol11a.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterLabel_Col11_Cash")
  cmblinfootcol11a.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterText_Col11_Cash")

  txtlinfootcol12a.Text = modSettings.ShowSettingFromFIle("Invoice/BiultIn_FooterLabel_Col12_Cash")
  cmblinfootcol12a.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterText_Col12_Cash")

  txtlinfootcol21a.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterLabel_Col21_Cash")
  cmblinfootcol21a.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterText_Col21_Cash")

  txtlinfootcol22a.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterLabel_Col22_Cash")
  cmblinfootcol22a.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterText_Col22_Cash")

  txtlinfootcol31a.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterLabel_Col31_Cash")
  cmblinfootcol31a.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterText_Col31_Cash")

  txtlinfootcol32a.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterLabel_Col32_Cash")
  cmblinfootcol32a.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterText_Col32_Cash")

  txtlinfootcol41a.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterLabel_Col41_Cash")
  cmblinfootcol41a.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterText_Col41_Cash")

  txtlinfootcol42a.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterLabel_Col42_Cash")
  cmblinfootcol42a.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterText_Col42_Cash")

End

Public Sub btnlinfootcol11a_Click()

  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterLabel_Col11_Cash", txtlinfootcol11a.Text)
  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterText_Col11_Cash", cmblinfootcol11a.Text)
  Balloon.Info(("Information updated"), btnlinfootcol11a)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnlinfootcol12a_Click()

  modSettings.SaveSettingsToFile("Invoice/BiultIn_FooterLabel_Col12_Cash", txtlinfootcol12a.Text)
  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterText_Col12_Cash", cmblinfootcol12a.Text)
  Balloon.Info(("Information updated"), btnlinfootcol12a)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnlinfootcol21a_Click()

  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterLabel_Col21_Cash", txtlinfootcol21a.Text)
  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterText_Col21_Cash", cmblinfootcol21a.Text)
  Balloon.Info(("Information updated"), btnlinfootcol21a)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnlinfootcol22a_Click()

  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterLabel_Col22_Cash", txtlinfootcol22a.Text)
  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterText_Col22_Cash", cmblinfootcol22a.Text)
  Balloon.Info(("Information updated"), btnlinfootcol22a)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnlinfootcol31a_Click()

  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterLabel_Col31_Cash", txtlinfootcol31a.Text)
  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterText_Col31_Cash", cmblinfootcol31a.Text)
  Balloon.Info(("Information updated"), btnlinfootcol31a)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnlinfootcol32a_Click()

  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterLabel_Col32_Cash", txtlinfootcol32a.Text)
  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterText_Col32_Cash", cmblinfootcol32a.Text)
  Balloon.Info(("Information updated"), btnlinfootcol32a)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnlinfootcol41a_Click()

  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterLabel_Col41_Cash", txtlinfootcol41a.Text)
  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterText_Col41_Cash", cmblinfootcol41a.Text)
  Balloon.Info(("Information updated"), btnlinfootcol41a)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnlinfootcol42a_Click()

  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterLabel_Col42_Cash", txtlinfootcol42a.Text)
  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterText_Col42_Cash", cmblinfootcol42a.Text)
  Balloon.Info(("Information updated"), btnlinfootcol42a)
  Balloon.Delay = modBasic.$BalloonDelay

End

''--------------------------------
Private Sub FooterEndLines()

  cmblinefootend1.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterEnd1")
  cmblinefootend2.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterEnd2")

  txtlinefootendcol1.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterEndCol1_Label")
  cmblinefootendcol1.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterEndCol1_Text")

  txtlinefootendcol2.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterEndCol2_Label")
  cmblinefootendcol2.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterEndCol2_Text")

End

Public Sub btnlinefootend1_Click()

  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterEnd1", cmblinefootend1.Text)
  Balloon.Info(("Information updated"), btnlinefootend1)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnlinefootend2_Click()

  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterEnd2", cmblinefootend2.Text)
  Balloon.Info(("Information updated"), btnlinefootend2)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnlinefootendcol1_Click()

  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterEndCol1_Label", txtlinefootendcol1.Text)
  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterEndCol1_Text", cmblinefootendcol1.Text)
  Balloon.Info(("Information updated"), btnlinefootendcol1)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnlinefootendcol2_Click()

  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterEndCol2_Label", txtlinefootendcol2.Text)
  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterEndCol2_Text", cmblinefootendcol2.Text)
  Balloon.Info(("Information updated"), btnlinefootendcol2)
  Balloon.Delay = modBasic.$BalloonDelay

End

''-------------------- ----- line footer credit -----------------------------------
Private Sub SHowLineFooter()

  txtlinfootcol11.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterLabel_Col11_Credit")
  cmblinfootcol11.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterText_Col11_Credit")

  txtlinfootcol12.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterLabel_Col12_Credit")
  cmblinfootcol12.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterText_Col12_Credit")

  txtlinfootcol21.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterLabel_Col21_Credit")
  cmblinfootcol21.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterText_Col21_Credit")

  txtlinfootcol22.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterLabel_Col22_Credit")
  cmblinfootcol22.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterText_Col22_Credit")

  txtlinfootcol31.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterLabel_Col31_Credit")
  cmblinfootcol31.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterText_Col31_Credit")

  txtlinfootcol32.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterLabel_Col32_Credit")
  cmblinfootcol32.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterText_Col32_Credit")

  txtlinfootcol41.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterLabel_Col41_Credit")
  cmblinfootcol41.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterText_Col41_Credit")

  txtlinfootcol42.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterLabel_Col42_Credit")
  cmblinfootcol42.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterText_Col42_Credit")

End

Public Sub btnlinfootcol11_Click()

  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterLabel_Col11_Credit", txtlinfootcol11.Text)
  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterText_Col11_Credit", cmblinfootcol11.Text)
  Balloon.Info(("Information updated"), btnlinfootcol11)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnlinfootcol12_Click()

  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterLabel_Col12_Credit", txtlinfootcol12.Text)
  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterText_Col12_Credit", cmblinfootcol12.Text)
  Balloon.Info(("Information updated"), btnlinfootcol12)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnlinfootcol21_Click()

  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterLabel_Col21_Credit", txtlinfootcol21.Text)
  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterText_Col21_Credit", cmblinfootcol21.Text)
  Balloon.Info(("Information updated"), btnlinfootcol21)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnlinfootcol22_Click()

  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterLabel_Col22_Credit", txtlinfootcol22.Text)
  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterText_Col22_Credit", cmblinfootcol22.Text)
  Balloon.Info(("Information updated"), btnlinfootcol22)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnlinfootcol31_Click()

  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterLabel_Col31_Credit", txtlinfootcol31.Text)
  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterText_Col31_Credit", cmblinfootcol31.Text)
  Balloon.Info(("Information updated"), btnlinfootcol31)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnlinfootcol32_Click()

  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterLabel_Col32_Credit", txtlinfootcol32.Text)
  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterText_Col32_Credit", cmblinfootcol32.Text)
  Balloon.Info(("Information updated"), btnlinfootcol32)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnlinfootcol41_Click()

  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterLabel_Col41_Credit", txtlinfootcol41.Text)
  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterText_Col41_Credit", cmblinfootcol41.Text)
  Balloon.Info(("Information updated"), btnlinfootcol41)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnlinfootcol42_Click()

  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterLabel_Col42_Credit", txtlinfootcol42.Text)
  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterText_Col42_Credit", cmblinfootcol42.Text)
  Balloon.Info(("Information updated"), btnlinfootcol42)
  Balloon.Delay = modBasic.$BalloonDelay

End

''-------------------------------------------------------------------------------------------------------
''------------------------------------ header -----------------------------------------------------------
Private Sub ShowHeaderSett()

  cmbhosp.Text = modSettings.ShowSettingFromFIle("Invoice/Header_HospitalName")
  cmbaddress.Text = modSettings.ShowSettingFromFIle("Invoice/Header_HospitalAddress")
  cmbdept.Text = modSettings.ShowSettingFromFIle("Invoice/DepartmentName")
  txtnamefont.Value = modSettings.ShowSettingFromFIle("Invoice/HospitalName_Font")
  txtaddfont.Value = modSettings.ShowSettingFromFIle("Invoice/HospitalAddress_Font")
  txtdeptfont.Value = modSettings.ShowSettingFromFIle("Invoice/Department_Font")
  cmbinvtypealign.Text = modSettings.ShowSettingFromFIle("Invoice/InvoiceType_Align")
  txtinvtypefont.Value = modSettings.ShowSettingFromFIle("Invoice/InvoiceType_Font")

  cmblogo.Text = modSettings.ShowSettingFromFIle("Invoice/Header_Logo")
  If modSettings.ShowSettingFromFIle("Invoice/Header_LogoWidth") Then
    txtlogowidth.Value = CFloat(modSettings.ShowSettingFromFIle("Invoice/Header_LogoWidth"))
  Endif
  If modSettings.ShowSettingFromFIle("Invoice/Header_LogoHeight") Then
    txtlogoheight.Value = CFloat(modSettings.ShowSettingFromFIle("Invoice/Header_LogoHeight"))
  Endif

  txtheaderpic.Text = modSettings.ShowSettingFromFIle("Invoice/Header_Picture")
  txtbackground.Text = modSettings.ShowSettingFromFIle("Invoice/Body_BackgroundPicture")
  txtfooterpict.Text = modSettings.ShowSettingFromFIle("Invoice/Footer_Picture")
  cmbportalqrform.Text = modSettings.ShowSettingFromFIle("Invoice/QRCodeLink")
  cmbnullinvoice.Text = modSettings.ShowSettingFromFIle("Invoice/NullFormat")

End

Public Sub txtheaderpic_Click()

  Dialog.Filter = ["*.jpg;*.jpeg;*.png;*.bmp", "Picture files"]
  If Dialog.OpenFile() Then Return
  txtheaderpic.Text = Dialog.Path

End

Public Sub btnheaderpic_Click()

  modSettings.SaveSettingsToFile("Invoice/Header_Picture", txtheaderpic.Text)
  Balloon.Info(("Information saved"), btnheaderpic)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnlogo_Click()

  modSettings.SaveSettingsToFile("Invoice/Header_Logo", cmblogo.Text)
  Balloon.Info(("Information saved"), btnlogo)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnlogodiamension_Click()

  If txtlogowidth.Value Then
    modSettings.SaveSettingsToFile("Invoice/Header_LogoWidth", CStr(txtlogowidth.Value))
  Endif
  If txtlogoheight.Value Then
    modSettings.SaveSettingsToFile("Invoice/Header_LogoHeight", CStr(txtlogoheight.Value))
  Endif
  Balloon.Info(("Information saved"), btnlogodiamension)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btntitle_Click()

  modSettings.SaveSettingsToFile("Invoice/Header_HospitalName", cmbhosp.Text)
  Balloon.Info(("Information saved"), btntitle)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnaddress_Click()

  modSettings.SaveSettingsToFile("Invoice/Header_HospitalAddress", cmbaddress.Text)
  Balloon.Info(("Information saved"), btnaddress)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btndeptshow_Click()

  modSettings.SaveSettingsToFile("Invoice/DepartmentName", cmbdept.Text)
  Balloon.Info(("Information saved"), btndeptshow)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnnamefont_Click()

  modSettings.SaveSettingsToFile("Invoice/HospitalName_Font", txtnamefont.Value)
  Balloon.Info(("Information saved"), btnnamefont)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnaddfont_Click()

  modSettings.SaveSettingsToFile("Invoice/HospitalAddress_Font", txtaddfont.Value)
  Balloon.Info(("Information saved"), btnaddfont)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btndeptfont_Click()

  modSettings.SaveSettingsToFile("Invoice/Department_Font", txtdeptfont.Value)
  Balloon.Info(("Information saved"), btndeptfont)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btninvtypealign_Click()

  modSettings.SaveSettingsToFile("Invoice/InvoiceType_Align", cmbinvtypealign.Text)
  Balloon.Info(("Information saved"), btninvtypealign)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btninvtypefont_Click()

  modSettings.SaveSettingsToFile("Invoice/InvoiceType_Font", txtinvtypefont.Value)
  Balloon.Info(("Information saved"), btninvtypefont)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub txtbackground_Click()

  Dialog.Filter = ["*.jpg;*.jpeg;*.png;*.bmp", "Picture files"]
  If Dialog.OpenFile() Then Return
  txtbackground.Text = Dialog.Path

End

Public Sub txtfooterpict_Click()

  Dialog.Filter = ["*.jpg;*.jpeg;*.png;*.bmp", "Picture files"]
  If Dialog.OpenFile() Then Return
  txtfooterpict.Text = Dialog.Path

End

Public Sub btnOkbackgrnd_Click()

  modSettings.SaveSettingsToFile("Invoice/Body_BackgroundPicture", txtbackground.Text)
  Balloon.Info(("Information saved"), btnOkbackgrnd)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnfootpic_Click()

  modSettings.SaveSettingsToFile("Invoice/Footer_Picture", txtfooterpict.Text)
  Balloon.Info(("Information saved"), btnfootpic)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnportalqrform_Click()

  modSettings.SaveSettingsToFile("Invoice/QRCodeLink", cmbportalqrform.Text)
  Balloon.Info(("Information saved"), btnportalqrform)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnnullinvoice_Click()

  modSettings.SaveSettingsToFile("Invoice/NullFormat", cmbnullinvoice.Text)
  Balloon.Info(("Information saved"), btnnullinvoice)
  Balloon.Delay = modBasic.$BalloonDelay

End

''--------------------------------- End Note ----------------------------------------------------------------------
Private Sub ShowEndNote()

  txtnote1.Text = modSettings.ShowSettingFromFIle("Invoice/EndNoteI_Text")
  txtfont1.Value = modSettings.ShowSettingFromFIle("Invoice/EndNoteI_Font")
  txtnote2.Text = modSettings.ShowSettingFromFIle("Invoice/EndNoteII_Text")
  txtfont2.Value = modSettings.ShowSettingFromFIle("Invoice/EndNoteII_Font")
  txtnote1.Font = Font[txtfont1.Value]
  txtnote2.Font = Font[txtfont2.Value]

End

Public Sub btnnote1_Click()

  modSettings.SaveSettingsToFile("Invoice/EndNoteI_Text", Trim(txtnote1.Text))
  modSettings.SaveSettingsToFile("Invoice/EndNoteI_Font", txtfont1.Value)
  Balloon.Info(("Information updated"), btnnote1)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnnote2_Click()

  modSettings.SaveSettingsToFile("Invoice/EndNoteII_Text", Trim(txtnote2.Text))
  modSettings.SaveSettingsToFile("Invoice/EndNoteII_Font", txtfont2.Value)
  Balloon.Info(("Information updated"), btnnote2)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub txtnote1_GotFocus()

  If txtfont1.Value Then
    txtnote1.Font = Font[txtfont1.Value]
  Endif

End

Public Sub txtnote2_GotFocus()

  If txtfont2.Value Then
    txtnote2.Font = Font[txtfont2.Text]
  Endif

End

''--------------------------------- PDF Page -----------------------------
Public Sub btncustomleft_Click()

  modSettings.SaveSettingsToFile("Invoice/PDF_LeftMargin", CStr(txtinvoiceleft.Value))
  Balloon.Info(("Information updated"), btncustomleft)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btncustomtop_Click()

  modSettings.SaveSettingsToFile("Invoice/PDF_TopMargin", CStr(txtinvoicetop.Value))
  Balloon.Info(("Information updated"), btncustomtop)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btncustomright_Click()

  modSettings.SaveSettingsToFile("Invoice/PDF_RightMargin", CStr(txtinvoiceright.Value))
  Balloon.Info(("Information updated"), btncustomright)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btncustombottom_Click()

  modSettings.SaveSettingsToFile("Invoice/PDF_BottomMargin", CStr(txtinvoicebottom.Value))
  Balloon.Info(("Information updated"), btncustombottom)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btncustomwidth_Click()

  modSettings.SaveSettingsToFile("Invoice/PDF_PageWidth", CStr(txtinvoicewidth.Value))
  Balloon.Info(("Information updated"), btncustomwidth)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btncustomheight_Click()

  modSettings.SaveSettingsToFile("Invoice/PDF_PageHeight", CStr(txtinvoiceheight.Value))
  Balloon.Info(("Information updated"), btncustomheight)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnpdforient_Click()

  modSettings.SaveSettingsToFile("Invoice/PDF_Orientation", cmbinvoiceorient.Text)
  Balloon.Info(("Information updated"), btnpdforient)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnPDFpapsize_Click()

  modSettings.SaveSettingsToFile("Invoice" & "/PDF_PaperSize", cmbPDpapsize.Text)
  Balloon.Info(("Information saved"), btnPDFpapsize)
  Balloon.Delay = modBasic.$BalloonDelay

End

Private Sub ShowInvoicePDF()

  If modSettings.ShowSettingFromFIle("Invoice/PDF_BottomMargin") Then
    txtinvoicebottom.Value = CInt(modSettings.ShowSettingFromFIle("Invoice/PDF_BottomMargin"))
  Endif
  If modSettings.ShowSettingFromFIle("Invoice/PDF_LeftMargin") Then
    txtinvoiceleft.Value = CInt(modSettings.ShowSettingFromFIle("Invoice/PDF_LeftMargin"))
  Endif
  If modSettings.ShowSettingFromFIle("Invoice/PDF_RightMargin") Then
    txtinvoiceright.Value = CInt(modSettings.ShowSettingFromFIle("Invoice/PDF_RightMargin"))
  Endif
  If modSettings.ShowSettingFromFIle("Invoice/PDF_TopMargin") Then
    txtinvoicetop.Value = CInt(modSettings.ShowSettingFromFIle("Invoice/PDF_TopMargin"))
  Endif

  If modSettings.ShowSettingFromFIle("Invoice/PDF_PageHeight") Then
    txtinvoiceheight.Value = CInt(modSettings.ShowSettingFromFIle("Invoice/PDF_PageHeight"))
  Endif
  If modSettings.ShowSettingFromFIle("Invoice/PDF_PageWidth") Then
    txtinvoicewidth.Value = CInt(modSettings.ShowSettingFromFIle("Invoice/PDF_PageWidth"))
  Endif

  cmbinvoiceorient.Text = modSettings.ShowSettingFromFIle("Invoice/PDF_Orientation")
  cmbPDpapsize.Text = modSettings.ShowSettingFromFIle("Invoice" & "/PDF_PaperSize")

End

''------------- General PDF Design --------------
Private Sub GeneralPDFDesign()

  cmbPDFbackground.Text = modSettings.ShowSettingFromFIle("Invoice" & "/PDF_BackgroundPrint")
  cmbPDFImage.Text = modSettings.ShowSettingFromFIle("Invoice" & "/PDF_ImagePrint")
  txtstylesheet.Text = modSettings.ShowSettingFromFIle("Invoice" & "/PDF_JavaScript")
  cmbPDFrotate.Text = modSettings.ShowSettingFromFIle("Invoice" & "/PDF_Rotate")

  cmbhtmlform.Text = modSettings.ShowSettingFromFIle("Invoice" & "/PDF_EnableForm")
  cmbhtmllink.Text = modSettings.ShowSettingFromFIle("Invoice" & "/PDF_EnableExternalLink")
  cmbgrayscale.Text = modSettings.ShowSettingFromFIle("Invoice" & "/PDF_GrayscalePrint")
  cmbinternalink.Text = modSettings.ShowSettingFromFIle("Invoice" & "/PDF_EnableInternalLink")
  cmbPDFshrink.Text = modSettings.ShowSettingFromFIle("Invoice" & "/PDF_SmartShrinking")
  cmblowquality.Text = modSettings.ShowSettingFromFIle("Invoice" & "/PDF_LowQuality")

End

Public Sub btnPDFbackground_Click()

  modSettings.SaveSettingsToFile("Invoice" & "/PDF_BackgroundPrint", cmbPDFbackground.Text)
  Balloon.Info(("Information saved"), btnPDFbackground)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnPDFImage_Click()

  modSettings.SaveSettingsToFile("Invoice" & "/PDF_ImagePrint", cmbPDFImage.Text)
  Balloon.Info(("Information saved"), btnPDFImage)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnPDFrotate_Click()

  modSettings.SaveSettingsToFile("Invoice" & "/PDF_Rotate", cmbPDFrotate.Text)
  Balloon.Info(("Information saved"), btnPDFrotate)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub txtstylesheet_Click()

  If Dialog.OpenFile() Then Return
  txtstylesheet.Text = Dialog.Path

End

Public Sub btnstylesheet_Click()

  modSettings.SaveSettingsToFile("Invoice" & "/PDF_JavaScript", txtstylesheet.Text)
  Balloon.Info(("Information saved"), btnstylesheet)
  Balloon.Delay = modBasic.$BalloonDelay

End

''new
Public Sub btnhtmlform_Click()

  modSettings.SaveSettingsToFile("Invoice" & "/PDF_EnableForm", cmbhtmlform.Text)
  Balloon.Info(("Information saved"), btnhtmlform)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnhtmllink_Click()

  modSettings.SaveSettingsToFile("Invoice" & "/PDF_EnableExternalLink", cmbhtmllink.Text)
  Balloon.Info(("Information saved"), btnhtmllink)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btngrayscale_Click()

  modSettings.SaveSettingsToFile("Invoice" & "/PDF_GrayscalePrint", cmbgrayscale.Text)
  Balloon.Info(("Information saved"), btngrayscale)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnsmshrink_Click()

  modSettings.SaveSettingsToFile("Invoice" & "/PDF_EnableInternalLink", cmbinternalink.Text)
  Balloon.Info(("Information saved"), btnsmshrink)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnPDFzoom_Click()

  modSettings.SaveSettingsToFile("Invoice" & "/PDF_SmartShrinking", cmbPDFshrink.Text)
  Balloon.Info(("Information saved"), btnPDFzoom)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnlowquality_Click()

  modSettings.SaveSettingsToFile("Invoice" & "/PDF_LowQuality", cmblowquality.Text)
  Balloon.Info(("Information saved"), btnlowquality)
  Balloon.Delay = modBasic.$BalloonDelay

End

''------------------------------------- PDF Header -----------------------------------------------
Private Sub ShowPDFVariable()

  Dim xx As String

  xx = "[page]:the number of the pages currently being printed" & gb.NewLine
  xx = xx & "[frompage]:the  number  of  the  first  page  to  be printed" & gb.NewLine
  xx = xx & "[topage]:the number of the last page to be printed" & gb.NewLine
  xx = xx & "[date]:the current date in system local format" & gb.NewLine
  xx = xx & "[time]:the current time in system local format"
  Message.Info(xx, ("OK"))

End

Public Sub bkpdfheadtext2_Click()

  ShowPDFVariable()

End

Public Sub bkpdfheadtext3_Click()

  ShowPDFVariable()

End

Public Sub bkpdfheadtext1_Click()

  ShowPDFVariable()

End

Private Sub PDFHeaderDesign()

  cmbpdfheadsource.Text = modSettings.ShowSettingFromFIle("Invoice" & "/PDFHeader_Source")

  txtpdfheadtextleft.Text = modSettings.ShowSettingFromFIle("Invoice" & "/PDFHeader_LeftText")
  txtpdfheadtextcenter.Text = modSettings.ShowSettingFromFIle("Invoice" & "/PDFHeader_CenterText")
  txtpdfheadtextright.Text = modSettings.ShowSettingFromFIle("Invoice" & "/PDFHeader_RightText")
  txtpdfheadfont.Value = modSettings.ShowSettingFromFIle("Invoice" & "/PDFHeader_Font")
  cmbpdfheadline.Text = modSettings.ShowSettingFromFIle("Invoice" & "/PDFHeader_Line")
  If modSettings.ShowSettingFromFIle("Invoice" & "/PDFHeader_Spacing") Then
    txtpdfheadspacing.Value = CInt(modSettings.ShowSettingFromFIle("Invoice" & "/PDFHeader_Spacing"))
  Endif

  modSettings.ShowCheckBox(chkpdfheadtitle, "Invoice" & "/PDFHeader_HTML_Title")
  modSettings.ShowCheckBox(chkpdfheadpatinfo, "Invoice" & "/PDFHeader_HTML_PatInfo")

End

Public Sub btnpdfheadfont_Click()

  modSettings.SaveSettingsToFile("Invoice" & "/PDFHeader_Font", txtpdfheadfont.Value)
  Balloon.Info(("Information saved"), btnpdfheadfont)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnpdfheadline_Click()

  modSettings.SaveSettingsToFile("Invoice" & "/PDFHeader_Line", cmbpdfheadline.Text)
  Balloon.Info(("Information saved"), btnpdfheadline)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnpdfheadsour_Click()

  modSettings.SaveSettingsToFile("Invoice" & "/PDFHeader_Source", cmbpdfheadsource.Text)
  Balloon.Info(("Information saved"), btnpdfheadsour)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnpdfheadtextleft_Click()

  modSettings.SaveSettingsToFile("Invoice" & "/PDFHeader_LeftText", txtpdfheadtextleft.Text)
  Balloon.Info(("Information saved"), btnpdfheadtextleft)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnpdfheadtextcenter_Click()

  modSettings.SaveSettingsToFile("Invoice" & "/PDFHeader_CenterText", txtpdfheadtextcenter.Text)
  Balloon.Info(("Information saved"), btnpdfheadtextcenter)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnpdfheadtextright_Click()

  modSettings.SaveSettingsToFile("Invoice" & "/PDFHeader_RightText", txtpdfheadtextright.Text)
  Balloon.Info(("Information saved"), btnpdfheadtextright)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnpdfheadsource_Click()

  modSettings.EnterCheckSetting(chkpdfheadtitle, "Invoice" & "/PDFHeader_HTML_Title")
  modSettings.EnterCheckSetting(chkpdfheadpatinfo, "Invoice" & "/PDFHeader_HTML_PatInfo")
  Balloon.Info(("Information saved"), btnpdfheadsource)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnpdfheadspacing_Click()

  modSettings.SaveSettingsToFile("Invoice" & "/PDFHeader_Spacing", CStr(txtpdfheadspacing.Value))
  Balloon.Info(("Information saved"), btnpdfheadspacing)
  Balloon.Delay = modBasic.$BalloonDelay

End

''----------------------------------------------------------------------------------------------
''------------------------------------- PDF footer -----------------------------------------------
Public Sub bkpdfoottext_Click()

  ShowPDFVariable()

End

Public Sub bkpdfoottext1_Click()

  ShowPDFVariable()

End

Public Sub bkpdfoottext2_Click()

  ShowPDFVariable()

End

Private Sub PDFFooterDesign()

  cmbpdfootsource.Text = modSettings.ShowSettingFromFIle("Invoice" & "/PDFFooter_Source")

  txtpdffoottextleft.Text = modSettings.ShowSettingFromFIle("Invoice" & "/PDFFooter_LeftText")
  txtpdffoottextcenter.Text = modSettings.ShowSettingFromFIle("Invoice" & "/PDFFooter_CanterText")
  txtpdffoottextright.Text = modSettings.ShowSettingFromFIle("Invoice" & "/PDFFooter_RightText")
  txtpdfootfont.Value = modSettings.ShowSettingFromFIle("Invoice" & "/PDFFooter_Font")
  cmbpdfootline.Text = modSettings.ShowSettingFromFIle("Invoice" & "/PDFFooter_Line")
  If modSettings.ShowSettingFromFIle("Invoice" & "/PDFFooter_Spacing") Then
    txtpdffootspacing.Value = CInt(modSettings.ShowSettingFromFIle("Invoice" & "/PDFFooter_Spacing"))
  Endif

  modSettings.ShowCheckBox(chkpdfootsigna, "Invoice" & "/PDFFooter_HTML_Signature")
  modSettings.ShowCheckBox(chkpdfootfoot, "Invoice" & "/PDFFooter_HTML_FooterImage")

End

Public Sub btnpdffoottextleft_Click()

  modSettings.SaveSettingsToFile("Invoice" & "/PDFFooter_LeftText", txtpdffoottextleft.Text)
  Balloon.Info(("Information saved"), btnpdffoottextleft)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnpdffoottextcenter_Click()

  modSettings.SaveSettingsToFile("Invoice" & "/PDFFooter_CanterText", txtpdffoottextcenter.Text)
  Balloon.Info(("Information saved"), btnpdffoottextcenter)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnpdffoottextright_Click()

  modSettings.SaveSettingsToFile("Invoice" & "/PDFFooter_RightText", txtpdffoottextright.Text)
  Balloon.Info(("Information saved"), btnpdffoottextright)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnpdfootfont_Click()

  modSettings.SaveSettingsToFile("Invoice" & "/PDFFooter_Font", txtpdfootfont.Value)
  Balloon.Info(("Information saved"), btnpdfootfont)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnpdfootline_Click()

  modSettings.SaveSettingsToFile("Invoice" & "/PDFFooter_Line", cmbpdfootline.Text)
  Balloon.Info(("Information saved"), btnpdfootline)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnpdfootsour_Click()

  modSettings.SaveSettingsToFile("Invoice" & "/PDFFooter_Source", cmbpdfootsource.Text)
  Balloon.Info(("Information saved"), btnpdfootsour)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnpdfootsource_Click()

  modSettings.EnterCheckSetting(chkpdfootsigna, "Invoice" & "/PDFFooter_HTML_Signature")
  modSettings.EnterCheckSetting(chkpdfootfoot, "Invoice" & "/PDFFooter_HTML_FooterImage")
  Balloon.Info(("Information saved"), btnpdfootsource)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnpdffootspacing_Click()

  modSettings.SaveSettingsToFile("Invoice" & "/PDFFooter_Spacing", CStr(txtpdffootspacing.Value))
  Balloon.Info(("Information saved"), btnpdffootspacing)
  Balloon.Delay = modBasic.$BalloonDelay

End

''--------------------------------------------- Table Design ---------------------------------------
Private Sub HeaderTableSetting()

  txtheadtablelabelfont.Value = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_HeaderTable_LabelFont")
  txtheadtabletextfont.Value = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_HeaderTable_TextFont")

  cmbheadtablelabelalign.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_HeaderTable_LabelAlignment")
  cmbheadtabletextalign.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_HeaderTable_TextAlignment")

  cmbheadlabelwidth.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_HeaderTable_LabelWidUnit")
  cmbheadtextwidth.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_HeaderTable_TextWidUnit")

  If modSettings.ShowSettingFromFIle("Invoice/BuiltIn_HeaderTable_LabelWidth") Then
    txtheadlabelwidth.Value = CInt(modSettings.ShowSettingFromFIle("Invoice/BuiltIn_HeaderTable_LabelWidth"))
  Endif
  If modSettings.ShowSettingFromFIle("Invoice/BuiltIn_HeaderTable_TextWidth") Then
    txtheadtextwidth.Value = CInt(modSettings.ShowSettingFromFIle("Invoice/BuiltIn_HeaderTable_TextWidth"))
  Endif

End

Public Sub btnheadtablelabelfont_Click()

  modSettings.SaveSettingsToFile("Invoice/BuiltIn_HeaderTable_LabelFont", txtheadtablelabelfont.Value)
  Balloon.Info(("Information saved"), btnheadtablelabelfont)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnheadtabletextfont_Click()

  modSettings.SaveSettingsToFile("Invoice/BuiltIn_HeaderTable_TextFont", txtheadtabletextfont.Value)
  Balloon.Info(("Information saved"), btnheadtabletextfont)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnheadtablelabelalign_Click()

  modSettings.SaveSettingsToFile("Invoice/BuiltIn_HeaderTable_LabelAlignment", cmbheadtablelabelalign.Text)
  If txtheadlabelwidth.Value Then
    modSettings.SaveSettingsToFile("Invoice/BuiltIn_HeaderTable_LabelWidth", txtheadlabelwidth.Value)
  Else
    modSettings.SaveSettingsToFile("Invoice/BuiltIn_HeaderTable_LabelWidth", "")
  Endif
  modSettings.SaveSettingsToFile("Invoice/BuiltIn_HeaderTable_LabelWidUnit", cmbheadlabelwidth.Text)
  Balloon.Info(("Information saved"), btnheadtablelabelalign)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnheadtabletextalign_Click()

  modSettings.SaveSettingsToFile("Invoice/BuiltIn_HeaderTable_TextAlignment", cmbheadtabletextalign.Text)
  If txtheadtextwidth.Value Then
    modSettings.SaveSettingsToFile("Invoice/BuiltIn_HeaderTable_TextWidth", txtheadtextwidth.Value)
  Else
    modSettings.SaveSettingsToFile("Invoice/BuiltIn_HeaderTable_TextWidth", "")
  Endif
  modSettings.SaveSettingsToFile("Invoice/BuiltIn_HeaderTable_TextWidUnit", cmbheadtextwidth.Text)
  Balloon.Info(("Information saved"), btnheadtabletextalign)
  Balloon.Delay = modBasic.$BalloonDelay

End

Private Sub FooterTableSetting()

  txtfoottablelabelfont.Value = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterTable_LabelFont")
  txtfoottabletextfont.Value = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterTable_TextFont")

  cmbfoottablelabelalign.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterTable_LabelAlignment")
  cmbfoottabletextalign.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterTable_TextAlignment")

  If modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterTable_LabelWidth") Then
    txtfootlabelwidth.Value = CInt(modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterTable_LabelWidth"))
  Endif
  If modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterTable_TextWidth") Then
    txtfoottextwidth.Value = CInt(modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterTable_TextWidth"))
  Endif

  cmbfootlabelwidth.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterTable_LabelWidUnit")
  cmbfoottextwidth.Text = modSettings.ShowSettingFromFIle("Invoice/BuiltIn_FooterTable_TextWidUnit")

End

Public Sub btnfoottablelabelfont_Click()

  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterTable_LabelFont", txtfoottablelabelfont.Value)
  Balloon.Info(("Information saved"), btnfoottablelabelfont)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnfoottabletextfont_Click()

  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterTable_TextFont", txtfoottabletextfont.Value)
  Balloon.Info(("Information saved"), btnfoottabletextfont)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnfoottablelabelalign_Click()

  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterTable_LabelAlignment", cmbfoottablelabelalign.Text)
  If txtfootlabelwidth.Value Then
    modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterTable_LabelWidth", txtfootlabelwidth.Value)
  Else
    modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterTable_LabelWidth", "")
  Endif
  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterTable_LabelWidUnit", cmbfootlabelwidth.Text)
  Balloon.Info(("Information saved"), btnfoottablelabelalign)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnfoottabletextalign_Click()

  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterTable_TextAlignment", cmbfoottabletextalign.Text)
  If txtfoottextwidth.Value Then
    modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterTable_TextWidth", txtfoottextwidth.Value)
  Else
    modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterTable_TextWidth", "")
  Endif
  modSettings.SaveSettingsToFile("Invoice/BuiltIn_FooterTable_TextWidUnit", cmbfoottextwidth.Text)
  Balloon.Info(("Information saved"), btnfoottabletextalign)
  Balloon.Delay = modBasic.$BalloonDelay

End

''-------------------------------------------------------------
Private Sub ShowTitleLabelSett()

  cmbtablelabel.Text = modSettings.ShowSettingFromFIle("Invoice/ShowColumnTitle")
  txttablelabelfont.Value = modSettings.ShowSettingFromFIle("Invoice/ColumnTitle_Font")
  cmbhidetable.Text = modSettings.ShowSettingFromFIle("Invoice/HideTable")

End

Public Sub btntablelabelsh_Click()

  modSettings.SaveSettingsToFile("Invoice/ShowColumnTitle", cmbtablelabel.Text)
  Balloon.Info(("Information saved"), btntablelabelsh)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btntablelabelfont_Click()

  modSettings.SaveSettingsToFile("Invoice/ColumnTitle_Font", txttablelabelfont.Value)
  Balloon.Info(("Information saved"), btntablelabelfont)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnhidetable_Click()

  modSettings.SaveSettingsToFile("Invoice/HideTable", cmbhidetable.Text)
  Balloon.Info(("Information saved"), btnhidetable)
  Balloon.Delay = modBasic.$BalloonDelay

End

''--------------------------------------------------------------------------------------
Private Sub ShowColumnWidthSett()

  If modSettings.ShowSettingFromFIle("Invoice/ColumnWidth1_Value") Then
    txtcolwid1.Value = CFloat(modSettings.ShowSettingFromFIle("Invoice/ColumnWidth1_Value"))
  Endif
  cmbcolwid1.Text = modSettings.ShowSettingFromFIle("Invoice/ColumnWidth1_Unit")
  cmbcolalign1.Text = modSettings.ShowSettingFromFIle("Invoice/ColumnAlign1")

  If modSettings.ShowSettingFromFIle("Invoice/ColumnWidth2_Value") Then
    txtcolwid2.Value = CFloat(modSettings.ShowSettingFromFIle("Invoice/ColumnWidth2_Value"))
  Endif
  cmbcolwid2.Text = modSettings.ShowSettingFromFIle("Invoice/ColumnWidth2_Unit")
  cmbcolalign2.Text = modSettings.ShowSettingFromFIle("Invoice/ColumnAlign2")

  If modSettings.ShowSettingFromFIle("Invoice/ColumnWidth3_Value") Then
    txtcolwid3.Value = CFloat(modSettings.ShowSettingFromFIle("Invoice/ColumnWidth3_Value"))
  Endif
  cmbcolwid3.Text = modSettings.ShowSettingFromFIle("Invoice/ColumnWidth3_Unit")
  cmbcolalign3.Text = modSettings.ShowSettingFromFIle("Invoice/ColumnAlign3")

  If modSettings.ShowSettingFromFIle("Invoice/ColumnWidth4_Value") Then
    txtcolwid4.Value = CFloat(modSettings.ShowSettingFromFIle("Invoice/ColumnWidth4_Value"))
  Endif
  cmbcolwid4.Text = modSettings.ShowSettingFromFIle("Invoice/ColumnWidth4_Unit")
  cmbcolalign4.Text = modSettings.ShowSettingFromFIle("Invoice/ColumnAlign4")

  If modSettings.ShowSettingFromFIle("Invoice/ColumnWidth5_Value") Then
    txtcolwid5.Value = CFloat(modSettings.ShowSettingFromFIle("Invoice/ColumnWidth5_Value"))
  Endif
  cmbcolwid5.Text = modSettings.ShowSettingFromFIle("Invoice/ColumnWidth5_Unit")
  cmbcolalign5.Text = modSettings.ShowSettingFromFIle("Invoice/ColumnAlign5")

  If modSettings.ShowSettingFromFIle("Invoice/ColumnWidth6_Value") Then
    txtcolwid6.Value = CFloat(modSettings.ShowSettingFromFIle("Invoice/ColumnWidth6_Value"))
  Endif
  cmbcolwid6.Text = modSettings.ShowSettingFromFIle("Invoice/ColumnWidth6_Unit")
  cmbcolalign6.Text = modSettings.ShowSettingFromFIle("Invoice/ColumnAlign6")

  If modSettings.ShowSettingFromFIle("Invoice/ColumnWidth7_Value") Then
    txtcolwid7.Value = CFloat(modSettings.ShowSettingFromFIle("Invoice/ColumnWidth7_Value"))
  Endif
  cmbcolwid7.Text = modSettings.ShowSettingFromFIle("Invoice/ColumnWidth7_Unit")
  cmbcolalign7.Text = modSettings.ShowSettingFromFIle("Invoice/ColumnAlign7")

  If modSettings.ShowSettingFromFIle("Invoice/ColumnWidth8_Value") Then
    txtcolwid8.Value = CFloat(modSettings.ShowSettingFromFIle("Invoice/ColumnWidth8_Value"))
  Endif
  cmbcolwid8.Text = modSettings.ShowSettingFromFIle("Invoice/ColumnWidth8_Unit")
  cmbcolalign8.Text = modSettings.ShowSettingFromFIle("Invoice/ColumnAlign8")

End

Public Sub btncolwid1_Click()

  If txtcolwid1.Value Then
    modSettings.SaveSettingsToFile("Invoice/ColumnWidth1_Value", CStr(txtcolwid1.Value))
  Else
    modSettings.SaveSettingsToFile("Invoice/ColumnWidth1_Value", "")
  Endif
  modSettings.SaveSettingsToFile("Invoice/ColumnWidth1_Unit", cmbcolwid1.Text)
  modSettings.SaveSettingsToFile("Invoice/ColumnAlign1", cmbcolalign1.Text)
  Balloon.Info(("Information saved"), btncolwid1)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btncolwid2_Click()

  If txtcolwid2.Value Then
    modSettings.SaveSettingsToFile("Invoice/ColumnWidth2_Value", CStr(txtcolwid2.Value))
  Else
    modSettings.SaveSettingsToFile("Invoice/ColumnWidth2_Value", "")
  Endif
  modSettings.SaveSettingsToFile("Invoice/ColumnWidth2_Unit", cmbcolwid2.Text)
  modSettings.SaveSettingsToFile("Invoice/ColumnAlign2", cmbcolalign2.Text)
  Balloon.Info(("Information saved"), btncolwid2)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btncolwid3_Click()

  If txtcolwid3.Value Then
    modSettings.SaveSettingsToFile("Invoice/ColumnWidth3_Value", CStr(txtcolwid3.Value))
  Else
    modSettings.SaveSettingsToFile("Invoice/ColumnWidth3_Value", "")
  Endif
  modSettings.SaveSettingsToFile("Invoice/ColumnWidth3_Unit", cmbcolwid3.Text)
  modSettings.SaveSettingsToFile("Invoice/ColumnAlign3", cmbcolalign3.Text)
  Balloon.Info(("Information saved"), btncolwid3)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btncolwid4_Click()

  If txtcolwid4.Value Then
    modSettings.SaveSettingsToFile("Invoice/ColumnWidth4_Value", CStr(txtcolwid4.Value))
  Else
    modSettings.SaveSettingsToFile("Invoice/ColumnWidth4_Value", "")
  Endif
  modSettings.SaveSettingsToFile("Invoice/ColumnWidth4_Unit", cmbcolwid4.Text)
  modSettings.SaveSettingsToFile("Invoice/ColumnAlign4", cmbcolalign4.Text)
  Balloon.Info(("Information saved"), btncolwid4)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btncolwid5_Click()

  If txtcolwid5.Value Then
    modSettings.SaveSettingsToFile("Invoice/ColumnWidth5_Value", CStr(txtcolwid5.Value))
  Else
    modSettings.SaveSettingsToFile("Invoice/ColumnWidth5_Value", "")
  Endif
  modSettings.SaveSettingsToFile("Invoice/ColumnWidth5_Unit", cmbcolwid5.Text)
  modSettings.SaveSettingsToFile("Invoice/ColumnAlign5", cmbcolalign5.Text)
  Balloon.Info(("Information saved"), btncolwid5)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btncolwid6_Click()

  If txtcolwid6.Value Then
    modSettings.SaveSettingsToFile("Invoice/ColumnWidth6_Value", CStr(txtcolwid6.Value))
  Else
    modSettings.SaveSettingsToFile("Invoice/ColumnWidth6_Value", "")
  Endif
  modSettings.SaveSettingsToFile("Invoice/ColumnWidth6_Unit", cmbcolwid6.Text)
  modSettings.SaveSettingsToFile("Invoice/ColumnAlign6", cmbcolalign6.Text)
  Balloon.Info(("Information saved"), btncolwid6)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btncolwid7_Click()

  If txtcolwid7.Value Then
    modSettings.SaveSettingsToFile("Invoice/ColumnWidth7_Value", CStr(txtcolwid7.Value))
  Else
    modSettings.SaveSettingsToFile("Invoice/ColumnWidth7_Value", "")
  Endif
  modSettings.SaveSettingsToFile("Invoice/ColumnWidth7_Unit", cmbcolwid7.Text)
  modSettings.SaveSettingsToFile("Invoice/ColumnAlign7", cmbcolalign7.Text)
  Balloon.Info(("Information saved"), btncolwid7)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btncolwid8_Click()

  If txtcolwid8.Value Then
    modSettings.SaveSettingsToFile("Invoice/ColumnWidth8_Value", CStr(txtcolwid8.Value))
  Else
    modSettings.SaveSettingsToFile("Invoice/ColumnWidth8_Value", "")
  Endif
  modSettings.SaveSettingsToFile("Invoice/ColumnWidth8_Unit", cmbcolwid8.Text)
  modSettings.SaveSettingsToFile("Invoice/ColumnAlign8", cmbcolalign8.Text)
  Balloon.Info(("Information saved"), btncolwid8)
  Balloon.Delay = modBasic.$BalloonDelay

End

''------------------------------------ Line Printing -------------------------------
Private Sub ShowLineFormaTable()

  txtlineformout.Text = modSettings.ShowSettingFromFIle("Invoice/LinePrintTable_Out")
  txtlineforminner.Text = modSettings.ShowSettingFromFIle("Invoice/LinePrintTable_In")
  txtlineformcol.Text = modSettings.ShowSettingFromFIle("Invoice/LinePrintTable_Col")
  cmblinetabletitle.Text = modSettings.ShowSettingFromFIle("Invoice/LinePrintTable_ColumnLabel")
  If modSettings.ShowSettingFromFIle("Invoice/LinePrintTable_Width") Then
    txtline_tablewid.Value = CInt(modSettings.ShowSettingFromFIle("Invoice/LinePrintTable_Width"))
  Endif
  If modSettings.ShowSettingFromFIle("Invoice/LinePrintTable_Height") Then
    txtline_tableht.Value = CInt(modSettings.ShowSettingFromFIle("Invoice/LinePrintTable_Height"))
  Endif

End

Public Sub btnlineinformat_Click()

  modSettings.SaveSettingsToFile("Invoice/LinePrintTable_In", txtlineforminner.Text)
  Balloon.Info(("Information updated"), btnlineinformat)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnlinecolformat_Click()

  modSettings.SaveSettingsToFile("Invoice/LinePrintTable_Col", txtlineformcol.Text)
  Balloon.Info(("Information updated"), btnlinecolformat)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnlineoutformat_Click()

  modSettings.SaveSettingsToFile("Invoice/LinePrintTable_Out", txtlineformout.Text)
  Balloon.Info(("Information updated"), btnlineoutformat)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnline_tableht_Click()

  modSettings.SaveSettingsToFile("Invoice/LinePrintTable_Height", CStr(txtline_tableht.Value))
  Balloon.Info(("Information updated"), btnline_tableht)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnline_tablewid_Click()

  modSettings.SaveSettingsToFile("Invoice/LinePrintTable_Width", CStr(txtline_tablewid.Value))
  Balloon.Info(("Information updated"), btnline_tablewid)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnlinetabletitle_Click()

  modSettings.SaveSettingsToFile("Invoice/LinePrintTable_ColumnLabel", cmblinetabletitle.Text)
  Balloon.Info(("Information updated"), btnlinetabletitle)
  Balloon.Delay = modBasic.$BalloonDelay

End

''----------------------------------------------------
Private Sub LinePrintColwidth()

  txtline_align1.Text = modSettings.ShowSettingFromFIle("Invoice/LinePrint_AlignCol1")
  txtline_align2.Text = modSettings.ShowSettingFromFIle("Invoice/LinePrint_AlignCol2")
  txtline_align3.Text = modSettings.ShowSettingFromFIle("Invoice/LinePrint_AlignCol3")
  txtline_align4.Text = modSettings.ShowSettingFromFIle("Invoice/LinePrint_AlignCol4")
  txtline_align5.Text = modSettings.ShowSettingFromFIle("Invoice/LinePrint_AlignCol5")
  txtline_align6.Text = modSettings.ShowSettingFromFIle("Invoice/LinePrint_AlignCol6")
  txtline_align7.Text = modSettings.ShowSettingFromFIle("Invoice/LinePrint_AlignCol7")
  txtline_align8.Text = modSettings.ShowSettingFromFIle("Invoice/LinePrint_AlignCol8")

  txtline_headalign1.Text = modSettings.ShowSettingFromFIle("Invoice/LinePrint_AlignHeadCol1")
  txtline_headalign2.Text = modSettings.ShowSettingFromFIle("Invoice/LinePrint_AlignHeadCol2")
  txtline_footalign1.Text = modSettings.ShowSettingFromFIle("Invoice/LinePrint_AlignFootCol1")
  txtline_footalign2.Text = modSettings.ShowSettingFromFIle("Invoice/LinePrint_AlignFootCol2")

  If modSettings.ShowSettingFromFIle("Invoice/LinePrint_WidthCol1") Then
    txtline_col1.Value = CInt(modSettings.ShowSettingFromFIle("Invoice/LinePrint_WidthCol1"))
  Endif
  If modSettings.ShowSettingFromFIle("Invoice/LinePrint_WidthCol2") Then
    txtline_col2.Value = CInt(modSettings.ShowSettingFromFIle("Invoice/LinePrint_WidthCol2"))
  Endif
  If modSettings.ShowSettingFromFIle("Invoice/LinePrint_WidthCol3") Then
    txtline_col3.Value = CInt(modSettings.ShowSettingFromFIle("Invoice/LinePrint_WidthCol3"))
  Endif
  If modSettings.ShowSettingFromFIle("Invoice/LinePrint_WidthCol4") Then
    txtline_col4.Value = CInt(modSettings.ShowSettingFromFIle("Invoice/LinePrint_WidthCol4"))
  Endif
  If modSettings.ShowSettingFromFIle("Invoice/LinePrint_WidthCol5") Then
    txtline_col5.Value = CInt(modSettings.ShowSettingFromFIle("Invoice/LinePrint_WidthCol5"))
  Endif
  If modSettings.ShowSettingFromFIle("Invoice/LinePrint_WidthCol6") Then
    txtline_col6.Value = CInt(modSettings.ShowSettingFromFIle("Invoice/LinePrint_WidthCol6"))
  Endif
  If modSettings.ShowSettingFromFIle("Invoice/LinePrint_WidthCol7") Then
    txtline_col7.Value = CInt(modSettings.ShowSettingFromFIle("Invoice/LinePrint_WidthCol7"))
  Endif
  If modSettings.ShowSettingFromFIle("Invoice/LinePrint_WidthCol8") Then
    txtline_col8.Value = CInt(modSettings.ShowSettingFromFIle("Invoice/LinePrint_WidthCol8"))
  Endif
  ''
  If modSettings.ShowSettingFromFIle("Invoice/LinePrint_WidthHeadCol1") Then
    txtline_headcol1.Value = CInt(modSettings.ShowSettingFromFIle("Invoice/LinePrint_WidthHeadCol1"))
  Endif
  If modSettings.ShowSettingFromFIle("Invoice/LinePrint_WidthHeadCol2") Then
    txtline_headcol2.Value = CInt(modSettings.ShowSettingFromFIle("Invoice/LinePrint_WidthHeadCol2"))
  Endif
  If modSettings.ShowSettingFromFIle("Invoice/LinePrint_WidthFootCol1") Then
    txtline_footcol1.Value = CInt(modSettings.ShowSettingFromFIle("Invoice/LinePrint_WidthFootCol1"))
  Endif
  If modSettings.ShowSettingFromFIle("Invoice/LinePrint_WidthFootCol2") Then
    txtline_footcol2.Value = CInt(modSettings.ShowSettingFromFIle("Invoice/LinePrint_WidthFootCol2"))
  Endif
  ''''
  If modSettings.ShowSettingFromFIle("Invoice/LinePrint_WidthHead-Head") Then
    txtline_headhead.Value = CInt(modSettings.ShowSettingFromFIle("Invoice/LinePrint_WidthHead-Head"))
  Endif
  If modSettings.ShowSettingFromFIle("Invoice/LinePrint_WidthFoot-Foot") Then
    txtline_footfoot.Value = CInt(modSettings.ShowSettingFromFIle("Invoice/LinePrint_WidthFoot-Foot"))
  Endif

End

Public Sub btnline_col1_Click()

  modSettings.SaveSettingsToFile("Invoice/LinePrint_WidthCol1", CStr(txtline_col1.Value))
  modSettings.SaveSettingsToFile("Invoice/LinePrint_AlignCol1", txtline_align1.Text)
  Balloon.Info(("Information updated"), btnline_col1)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnline_col2_Click()

  modSettings.SaveSettingsToFile("Invoice/LinePrint_WidthCol2", CStr(txtline_col2.Value))
  modSettings.SaveSettingsToFile("Invoice/LinePrint_AlignCol2", txtline_align2.Text)
  Balloon.Info(("Information updated"), btnline_col2)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnline_col3_Click()

  modSettings.SaveSettingsToFile("Invoice/LinePrint_WidthCol3", CStr(txtline_col3.Value))
  modSettings.SaveSettingsToFile("Invoice/LinePrint_AlignCol3", txtline_align3.Text)
  Balloon.Info(("Information updated"), btnline_col3)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnline_col4_Click()

  modSettings.SaveSettingsToFile("Invoice/LinePrint_WidthCol4", CStr(txtline_col4.Value))
  modSettings.SaveSettingsToFile("Invoice/LinePrint_AlignCol4", txtline_align4.Text)
  Balloon.Info(("Information updated"), btnline_col4)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnline_col5_Click()

  modSettings.SaveSettingsToFile("Invoice/LinePrint_WidthCol5", CStr(txtline_col5.Value))
  modSettings.SaveSettingsToFile("Invoice/LinePrint_AlignCol5", txtline_align5.Text)
  Balloon.Info(("Information updated"), btnline_col5)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnline_col6_Click()

  modSettings.SaveSettingsToFile("Invoice/LinePrint_WidthCol6", CStr(txtline_col6.Value))
  modSettings.SaveSettingsToFile("Invoice/LinePrint_AlignCol6", txtline_align6.Text)
  Balloon.Info(("Information updated"), btnline_col6)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnline_col7_Click()

  modSettings.SaveSettingsToFile("Invoice/LinePrint_WidthCol7", CStr(txtline_col7.Value))
  modSettings.SaveSettingsToFile("Invoice/LinePrint_AlignCol7", txtline_align7.Text)
  Balloon.Info(("Information updated"), btnline_col7)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnline_col8_Click()

  modSettings.SaveSettingsToFile("Invoice/LinePrint_WidthCol8", CStr(txtline_col8.Value))
  modSettings.SaveSettingsToFile("Invoice/LinePrint_AlignCol8", txtline_align8.Text)
  Balloon.Info(("Information updated"), btnline_col8)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnline_headcol1_Click()

  modSettings.SaveSettingsToFile("Invoice/LinePrint_WidthHeadCol1", CStr(txtline_headcol1.Value))
  modSettings.SaveSettingsToFile("Invoice/LinePrint_AlignHeadCol1", txtline_headalign1.Text)
  Balloon.Info(("Information updated"), btnline_headcol1)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnline_headcol2_Click()

  modSettings.SaveSettingsToFile("Invoice/LinePrint_WidthHeadCol2", CStr(txtline_headcol2.Value))
  modSettings.SaveSettingsToFile("Invoice/LinePrint_AlignHeadCol2", txtline_headalign2.Text)
  Balloon.Info(("Information updated"), btnline_headcol2)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnline_footcol1_Click()

  modSettings.SaveSettingsToFile("Invoice/LinePrint_WidthFootCol1", CStr(txtline_footcol1.Value))
  modSettings.SaveSettingsToFile("Invoice/LinePrint_AlignFootCol1", txtline_footalign1.Text)
  Balloon.Info(("Information updated"), btnline_footcol1)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnline_footcol2_Click()

  modSettings.SaveSettingsToFile("Invoice/LinePrint_WidthFootCol2", CStr(txtline_footcol2.Value))
  modSettings.SaveSettingsToFile("Invoice/LinePrint_AlignFootCol2", txtline_footalign2.Text)
  Balloon.Info(("Information updated"), btnline_footcol2)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnline_headhead_Click()

  modSettings.SaveSettingsToFile("Invoice/LinePrint_WidthHead-Head", CStr(txtline_headhead.Value))
  Balloon.Info(("Information updated"), btnline_headhead)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnline_footfoot_Click()

  modSettings.SaveSettingsToFile("Invoice/LinePrint_WidthFoot-Foot", CStr(txtline_footfoot.Value))
  Balloon.Info(("Information updated"), btnline_footfoot)
  Balloon.Delay = modBasic.$BalloonDelay

End

''----------------------------------------------- Blank Lines in Line Print ------------------------------------------
Private Sub ShowInvBlankLine()

  If modSettings.ShowSettingFromFIle("Invoice/LinePrint_BlankLine_BeforeTitle") Then
    txtline_blankstart.Value = CInt(modSettings.ShowSettingFromFIle("Invoice/LinePrint_BlankLine_BeforeTitle"))
  Endif
  If modSettings.ShowSettingFromFIle("Invoice/LinePrint_BlankLine_Title_Head") Then
    txtline_title_head.Value = CInt(modSettings.ShowSettingFromFIle("Invoice/LinePrint_BlankLine_Title_Head"))
  Endif
  If modSettings.ShowSettingFromFIle("Invoice/LinePrint_BlankLine_Head_Body") Then
    txtline_head_body.Value = CInt(modSettings.ShowSettingFromFIle("Invoice/LinePrint_BlankLine_Head_Body"))
  Endif
  If modSettings.ShowSettingFromFIle("Invoice/LinePrint_BlankLine_Body_Footer") Then
    txtline_body_footer.Value = CInt(modSettings.ShowSettingFromFIle("Invoice/LinePrint_BlankLine_Body_Footer"))
  Endif
  If modSettings.ShowSettingFromFIle("Invoice/LinePrint_BlankLine_AfterFooter") Then
    txtline_afterfoot.Value = CInt(modSettings.ShowSettingFromFIle("Invoice/LinePrint_BlankLine_AfterFooter"))
  Endif
  If modSettings.ShowSettingFromFIle("Invoice/LinePrint_BlankLine_BetweenPages") Then
    txtline_twopages.Value = CInt(modSettings.ShowSettingFromFIle("Invoice/LinePrint_BlankLine_BetweenPages"))
  Endif

End

Public Sub btnline_blankstart_Click()

  modSettings.SaveSettingsToFile("Invoice/LinePrint_BlankLine_BeforeTitle", CStr(txtline_blankstart.Value))
  Balloon.Info(("Information updated"), btnline_blankstart)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btntline_itle_head_Click()

  modSettings.SaveSettingsToFile("Invoice/LinePrint_BlankLine_Title_Head", CStr(txtline_title_head.Value))
  Balloon.Info(("Information updated"), btntline_itle_head)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnline_head_body_Click()

  modSettings.SaveSettingsToFile("Invoice/LinePrint_BlankLine_Head_Body", CStr(txtline_head_body.Value))
  Balloon.Info(("Information updated"), btnline_head_body)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnline_body_footer_Click()

  modSettings.SaveSettingsToFile("Invoice/LinePrint_BlankLine_Body_Footer", CStr(txtline_body_footer.Value))
  Balloon.Info(("Information updated"), btnline_body_footer)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnline_afterfooter_Click()

  modSettings.SaveSettingsToFile("Invoice/LinePrint_BlankLine_AfterFooter", CStr(txtline_afterfoot.Value))
  Balloon.Info(("Information updated"), btnline_afterfooter)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnline_twopages_Click()

  modSettings.SaveSettingsToFile("Invoice/LinePrint_BlankLine_BetweenPages", CStr(txtline_twopages.Value))
  Balloon.Info(("Information updated"), btnline_twopages)
  Balloon.Delay = modBasic.$BalloonDelay

End

''----------------------------------Line Page Format-------------------
Private Sub LinePageFormatSetting()

  If modSettings.ShowSettingFromFIle("Invoice/LinePrint_PageMaxHeight") Then
    txtlinepagemaxht.Value = CInt(modSettings.ShowSettingFromFIle("Invoice/LinePrint_PageMaxHeight"))
  Endif
  cmblinepageformat.Text = modSettings.ShowSettingFromFIle("Invoice/LinePrint_PageOutputFormat")

End

Public Sub btnlinepageformat_Click()

  modSettings.SaveSettingsToFile("Invoice/LinePrint_PageOutputFormat", cmblinepageformat.Text)
  Balloon.Info(("Information updated"), btnlinepageformat)
  Balloon.Delay = modBasic.$BalloonDelay

End

Public Sub btnlinepagemaxht_Click()

  modSettings.SaveSettingsToFile("Invoice/LinePrint_PageMaxHeight", txtlinepagemaxht.Value)
  Balloon.Info(("Information updated"), btnlinepagemaxht)
  Balloon.Delay = modBasic.$BalloonDelay

End
