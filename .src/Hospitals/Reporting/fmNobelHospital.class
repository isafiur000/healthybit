' Gambas class file

Public Sub Form_Open()

  Me.Center()
  modHospitalReport.CreateLabConnections()
  dtfrom.Value = Now()
  dtlast.Value = Now()

End

Public Sub Form_Close()

  Try modHospitalReport.$lab1Con.Close
  Try modHospitalReport.$lab2Con.Close

End

Public Sub dtnepfir_Click()

  Dim xx As String

  xx = BSDateFormat(("Enter BS Date in yyyy/mm/dd format"), ("Date Converter"), modDate.ConvertToLocaldate(dtfrom.Value))
  If xx Then
    dtfrom.Value = modDate.ConvertToEnglishdate(xx)
  Endif

End

Public Sub dtneplast_Click()

  Dim xx As String

  xx = BSDateFormat(("Enter BS Date in yyyy/mm/dd format"), ("Date Converter"), modDate.ConvertToLocaldate(dtlast.Value))
  If xx Then
    dtlast.Value = modDate.ConvertToEnglishdate(xx)
  Endif

End

'''========================= Reports ==================
Public Sub btnavgcoll_Click()

  Dim xPath As String

  Inc Application.Busy
  xPath = modHospitalReport.ShowSummaryNobelHospital(dtfrom.Value, dtlast.Value)
  Dec Application.Busy
  modControlSub.OpenHTMLPreview("", xPath, "ReportSize")

End

Public Sub btncashcoll_Click()

  Dim xPath As String

  Inc Application.Busy
  xPath = modHospitalReport.ShowCashNobelHospital(dtfrom.Value, dtlast.Value)
  Dec Application.Busy
  modControlSub.OpenHTMLPreview("", xPath, "ReportSize")

End
