' Gambas class file

Private $sCon As Connection

Public Sub _new(sCon As Connection)

  $sCon = sCon

End

Public Sub Form_Open()

  Me.Center
  txthost.Text = System.Host
  txtip.Text = modApplication.GetLocalIP()
  txtmac.Text = modApplication.GetMACAddress()
  txtcompname.Text = System.User.Name
  txtcomp.List = modMisc.CompIDList()

End

Public Sub btnadmin_Click()

  modAppSupport.AddRecordLoginParam($sCon, txtaduser.Text, Trim(txtadpass.Text), Trim(txtadroot.Text), txtcomp.Text, chkadmin.Text)             ''

End

Public Sub cmdaccess_Click()

  modAppSupport.AddInitialAccessSetup($sCon, txtmac.Text, txtcompname.Text, txtip.Text, txthost.text, txtcomp.Text)

End
